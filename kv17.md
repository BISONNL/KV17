![](media/image1.jpeg){width="2.6770833333333335in"
height="1.2604166666666667in"}

**Specificatie TMI8**

**Mutaties op het operationeel proces**

***Koppelvlak 17***

*Versie: 8.2.0.0 *

*Datum: 24 november 2017*

*Status: release*

*Bestand: TMI8 Mutaties op het operationeel proces (kv 17), v8.2.0.0,
release.docx*

© Platform Beheer Informatie Standaarden OV Nederland (BISON), 2017

Op dit werk is de Creative Commons Licentie/ by-nd/3.0/nl van
toepassing.\
http://creativecommons.org/licenses/by-nd/3.0/nl/

<span id="_Toc228202372" class="anchor"><span id="_Toc230402521"
class="anchor"><span id="_Toc208375621"
class="anchor"></span></span></span>**Copyright**

Dit document is eigendom van het Platform BISON onder de Stichting
Connekt, en wordt gepubliceerd onder de Creative Commons Naamsvermelding
- Geen Afgeleide werken 3.0 Nederland licentie (Creative Commons
Licensie by-nd/3.0/nl).

De Creative Commons Naamsvermelding - Geen Afgeleide werken 3.0
Nederland licentie in het kort:

De gebruiker mag:

-   het werk kopiëren, verspreiden en doorgeven

Onder de volgende voorwaarden:

1.  **Naamsvermelding**. De gebruiker dient bij het werk de door de
    maker of de licentiegever aangegeven naam te vermelden (maar niet
    zodanig dat de indruk gewekt wordt dat zij daarmee instemmen met uw
    werk of uw gebruik van het werk).

2.  **Geen Afgeleide werken**. De gebruiker mag het werk niet bewerken.

3.  Bij hergebruik of verspreiding dient de gebruiker de
    licentievoorwaarden van dit werk kenbaar te maken aan derden. De
    beste manier om dit te doen is door middel van een link naar de
    webpagina <http://creativecommons.org/licenses/by-nd/3.0/nl>.

4.  De gebruiker mag afstand doen van een of meerdere van deze
    voorwaarden met voorafgaande toestemming van de rechthebbende.

5.  Niets in deze licentie strekt ertoe afbreuk te doen aan de morele
    rechten van de auteur, of deze te beperken.

Zie voor de volledige licentie
<http://creativecommons.org/licenses/by-nd/3.0/nl> of Bijlage 5 van dit
document.

Voor vragen over en/of wijzigingen op dit document de documenten en/of
bestanden die erbij horen, dient u contact op te nemen met het Platform
BISON (<http://bison.connekt.nl>).

![](media/image2.png){width="5.625in" height="0.3541666666666667in"}\
<span id="_Toc222833820"
class="anchor"></span>**Wijzigingsgeschiedenis**

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Versie**    **Datum**    **Status**        **Behandeld door**   **Opmerking**
  ------------- ------------ ----------------- -------------------- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  8.1.0.0(a)    18/06/2009   Concept           Werkgroep            Initiële document op basis van TMI8.10 c van 27 maart 2009

  8.1.0.0(b)    21/07/2009   Concept           Werkgroep            Input vergaderingen 23/6 en 30/6 verwerkt

  8.1.0.0(c)    11/08/2009   Concept           Werkgroep            Verdere input eerdere vergaderingen verwerkt; scope uitgebreid met nieuwe functionaliteit (ADD, MODIFY, enz.)

  8.1.0.0(d)    9/9/2009     Concept           Werkgroep            Input vergadering 1 september verwerkt

  8.1.0.0(e)    18/9/2009    Concept           Werkgroep            Input vergadering 15 september verwerkt, o.a.:
                                                                    
                                                                    1.  Aanpassingen compatibiliteit TM5
                                                                    
                                                                        -   FortifyOrderNumber = ReinforcementNumber
                                                                    
                                                                        -   OperationDate = OperatingDay
                                                                    
                                                                    2.  Ondersteuning versterkingsritten geschrapt (o.a. scenario’s (ReinforcementNumber is altijd 0)
                                                                    
                                                                    3.  Hoofdstukindeling aangepast
                                                                    
                                                                    4.  ERD verplaatst naar bijlage
                                                                    
                                                                    5.  PassageSequenceNumber en gebruik SIRI codes beter toegelicht
                                                                    
                                                                    6.  Heartbeat geschrapt
                                                                    
                                                                    7.  Definities timestamps aangepast
                                                                    
                                                                    8.  Diverse tekstuele verbeteringen
                                                                    
                                                                    

  8.1.0.0(f)    23/09/2009   Concept           Werkgroep            Opmerking n.a.v. review d.d. 22/09/09 verwerkt:
                                                                    
                                                                    1.  Tekstueel
                                                                    
                                                                    2.  Aanpassen scenario’s
                                                                    
                                                                    3.  HTTP-POST beschrijving bijgewerkt
                                                                    
                                                                    4.  Openstaande punten verwijderd voor zover van toepassing
                                                                    
                                                                    5.  Aanpassen XSD i.v.m. met het omhoog schuiven van de timestamp.
                                                                    
                                                                    6.  KV17cvlingreep vervangen door KV17CVLinfo
                                                                    
                                                                    

  8.1.0.0(g)    08/10/2009   Draft             Werkgroep            Opmerking n.a.v. extra werkgroep d.d. 01/10/09:
                                                                    
                                                                    1.  Aanpassen gebruik CHANGEPASSTIMES
                                                                    
                                                                    2.  Aanpassen scenario’s rondom CHANGEPASSTIMES.
                                                                    
                                                                    3.  N.a.v. discussie rond vrije tekst op ritniveau toegevoegd een scenario met ritgerelateerde vrije tekst.
                                                                    
                                                                    

  8.1.0.0.(g)   12/10/2009   Draft             Werkgroep            1.  Laatste tekstuele opmerking verwerkt, CXX, GOVI, ARRIVA.
                                                                    
                                                                    

  8.1.0.1.(h)   9/1/2014     Draft             Werkgroep            Aanpassen par. 2.2: enumeraties en tabellen
                                                                    
                                                                    Bijlage 2: Correctie application/zip =&gt; application/gzip

  8.1.0.1       6/2/2014     Release                                

  8.1.1.0       19/9/2014    Draft             Werkgroep            Rfc KV17 Skip functionaliteit verwerkt in document. Skip functionaliteit (overslaan van haltepassages) wordt gerealiseerd door toe te staan dat Shorten mag worden gebruikt voor alle haltes van een rit.

  8.1.1.0       7/11/2014    Release           Werkgroep            Goedgekeurd tot release door de SC van 24/10/2014.

  8.1.1.1       3/3/2017     Release           AW                   Verduidelijken interpretatie KV17LAG en verwerking KV17CHANGEPASSTIMES.

                26/4/2017    Release                                Aanscherping tekst door Architectuur Werkgroep.

  8.2.0.0       14/7/2017    Concept(a)        AW                   -   Attribuut ‘ClearDown’ bij CANCEL en SHORTEN.
                                                                    
                                                                    -   Toelichting gebruik samenhangende optionele velden.
                                                                    
                                                                    -   Volgorde attribuut Timestamp in definitie van SHORTEN, LAG, CHANGEPASSTIMES en CHANGEDESTINATION aangepast aan xsd.
                                                                    
                                                                    

                14/9/2017    Concept(b)        AW                   - ‘ClearDown’ hernoemd in ‘ShowTrip’
                                                                    
                                                                    - Gebruik VERSION explicieter beschreven

                29/9/2017    Concept(c)        AW                   - ‘ShowTrip’ hernoemd in ‘ShowCancelledTrip’ en ook toegevoegd aan MUTATIONMESSAGE
                                                                    
                                                                    - Extra scenario m.b.t. ‘ShowCancelledTrip’

                12/10/2017   Draft (d)         CAB                  Versie voor CAB.

                31/10/2017   Pre-release (e)   SC                   Versie voor SC.

                24/11/2017   Release                                Goedgekeurd door Strategic Committee, d.d. 24-11-2017.
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

<span id="_Toc222833821" class="anchor"></span>***Openstaande punten***

1.  Gelieve mee te denken over de wijze waarop de
    state-transitiediagrammen moeten worden ingevuld. Die zijn in dit
    concept vooralsnog weggelaten.

**Inhoudsopgave**

[1. Introductie 6](#_Toc525037154)

[1.1. Doel en korte beschrijving van het koppelvlak 6](#_Toc525037155)

[1.1.1. Mutaties op het operationeel proces (koppelvlak 17)
6](#_Toc525037156)

[1.1.2. Koppelvlak leveranciers 6](#_Toc525037157)

[1.1.3. Koppelvlak afnemers 6](#_Toc525037158)

[1.2. Overwegingen en aannamen bij ontwerp koppelvlak 17
6](#_Toc525037159)

[1.3. Doel en uitgangspunten van het koppelvlak 7](#_Toc525037160)

[1.4. Plaats van de koppelvlak in het model
8](#plaats-van-de-koppelvlak-in-het-model)

[1.5. Globale procesbeschrijving 8](#globale-procesbeschrijving)

[1.5.1. Algemene scenario’s 9](#algemene-scenarios)

[1.5.2. Technische opmerkingen 10](#technische-opmerkingen)

[1.5.3. Haltes 11](#haltes)

[1.5.4. Haltepassages 11](#haltepassages)

[2. Bericht definities 12](#_Toc525037167)

[2.1. Legenda 12](#_Toc525037168)

[2.2. Gebruik van enumeraties en tabellen 12](#_Toc525037169)

[2.3. Tabellen 13](#tabellen)

[2.3.1. Interpretatie gebruikte tabel
13](#interpretatie-gebruikte-tabel)

[2.3.2. Berichten 13](#berichten)

[2.3.3. Interactie tussen Koppelvlak 17 en andere Koppelvlakken
20](#_Toc525037173)

[2.4. Entity Relationship Diagrammen (ERD) 20](#_Toc525037174)

[3. Semantiek en Achtergronden 21](#_Toc525037175)

[3.1. Business regels specifiek voor koppelvlak 17 21](#_Toc525037176)

[3.2. Gebruik van PassageSequenceNumber 21](#_Toc525037177)

[3.3. Gebruik van Reason- en Advice-codes of –teksten
21](#gebruik-van-reason--en-advice-codes-of-teksten)

[3.4. Gebruik van JourneyStopType 22](#gebruik-van-journeystoptype)

[3.5. Toestanden (states) in koppelvlak 17
22](#toestanden-states-in-koppelvlak-17)

[4. Het verwerken van koppelvlak berichten 23](#_Toc525037181)

[4.1. Koppelvlak scenario’s 23](#koppelvlak-scenarios)

[4.1.1. Scenario 1: een geplande of actieve rit vervalt
23](#_Toc525037183)

[4.1.2. Scenario 2: Een eerder vervallen rit zal toch rijden
24](#scenario-2-een-eerder-vervallen-rit-zal-toch-rijden)

[4.1.3. Scenario 3: De eerste halte van een rit vervalt
25](#_Toc525037185)

[4.1.4. Scenario 4: Laatste passage van een rit vervalt en bestemming
wijzigt
26](#scenario-4-laatste-passage-van-een-rit-vervalt-en-bestemming-wijzigt)

[4.1.5. Scenario 5: Vertrektijd op één halte worden 5 minuten uitgesteld
27](#scenario-5-vertrektijd-op-één-halte-worden-5-minuten-uitgesteld)

[4.1.6. Scenario 6: Passage op rit krijgt andere geplande aankomst- en
vertrektijden
28](#scenario-6-passage-op-rit-krijgt-andere-geplande-aankomst--en-vertrektijden)

[4.1.7. Scenario 7: Een vervallen passage niet meer tonen
29](#scenario-7-een-vervallen-passage-niet-meer-tonen)

[5. Berichten 30](#berichten-1)

[5.1. Het PUSH document 30](#_Toc525037191)

[5.2. Het RESPONSE document 31](#_Toc525037192)

[5.3. Het REQUEST document 32](#het-request-document)

[5.4. Het systeem HEARTBEAT document
32](#het-systeem-heartbeat-document)

[5.5. XML Document responsetijden 33](#xml-document-responsetijden)

[5.6. Maximale tijd tussen berichten
33](#maximale-tijd-tussen-berichten)

[5.7. XML Schema Definitie 33](#xml-schema-definitie)

[5.8. Verzendmechanisme / Protocol 33](#verzendmechanisme-protocol)

[5.9. Transport parameters 33](#transport-parameters)

[6. Bijlage 1: XML Schema Definitie 34](#_Toc525037200)

[7. Bijlage 2: Verzendmechanisme / Protocol 40](#_Toc525037201)

[8. Bijlage 3: Voorbeeld scenario gebruik koppelvlak 17 in Utrecht
42](#_Toc525037202)

[9. Bijlage 4: Voorbeeld technische koppeling tussen koppelvlak 17 en
koppelvlak 1 44](#_Toc525037203)

[10. Bijlage 5: Creative Commons by/nd/3.0/nl licentie
46](#bijlage-5-creative-commons-bynd3.0nl-licentie)

**Inhoudsopgave Tabellen**

[Tabel 1 Legenda 12](#_Toc525037205)

[Tabel 2 Definitie object tabel 13](#_Toc525037206)

[Tabel 3 CANCEL (laat een rit vervallen) 14](#_Toc525037207)

[Tabel 4 SHORTEN (laat passage op een rit vervallen) 15](#_Toc525037208)

[Tabel 5 RECOVER (herstelt eerdere ingrepen) 15](#_Toc525037209)

[Tabel 6 ADD (gereserveerd) 16](#_Toc525037210)

[Tabel 7 LAG (Stelt vertrek van specifieke passage bepaalde tijd uit)
16](#_Toc525037211)

[Tabel 8 CHANGEPASSTIMES (verandert geplande aankomst- en vertrektijden
van passage) 17](#_Toc525037212)

[Tabel 9 CHANGEDESTINATION (verandert bestemming van passerende rit)
18](#_Toc525037213)

[Tabel 10 MUTATIONMESSAGE (communiceert oorzaak en/of advies voor
reiziger) 19](#_Toc525037214)

[Tabel 11 Interactie Koppelvlak 17 en Koppelvlak 8 20](#_Toc525037215)

[Tabel 12 Gebruik van JourneyStopType 22](#_Toc525037216)

[Tabel 13 PUSH document informatie 31](#_Toc525037217)

[Tabel 14 RESPONSE document informatie 32](#_Toc525037218)

[Tabel 15 REQUEST document informatie 32](#_Toc525037219)

[Tabel 16 XML Document responsetijden 33](#_Toc525037220)

[Tabel 17 Maximale tijd tussen twee XML PUSH documenten
33](#_Toc525037221)

[Tabel 18 XML schema definitie per koppelvlak versie 33](#_Toc525037222)

[Tabel 19 Transport parameters 33](#_Toc525037223)

**Inhoudsopgave Figuren**

[Figuur 1 Schematisch vervoerproces 7](#_Toc525037224)

[Figuur 2 Plaats van koppelvlak 17 8](#_Toc525037225)

[Figuur 3 Scenario 1: Een geplande of actieve rit vervalt
23](#_Toc525037226)

[Figuur 4 Scenario 2: Een eerder vervallen rit zal toch rijden
24](#_Toc525037227)

[Figuur 5 Scenario 3: De eerste halte van een rit vervalt
25](#_Toc525037228)

[Figuur 6 Scenario 4: Laatste halte van een rit vervalt en bestemming
wijzigt 26](#_Toc525037229)

[Figuur 7 Scenario 5: Haltetijden op één halte worden 5 minuten
uitgesteld 27](#_Toc525037230)

[Figuur 8 Scenario 6: Een passage op een rit krijgt andere geplande
aankomst- en vertrektijden 28](#_Toc525037231)

[Figuur 9 Scenario 7: Een vervallen rit niet meer tonen
29](#_Toc525037232)

[Figuur 10 XSD VV\_TM\_PUSH 34](#_Toc525037233)

[Figuur 11 XSD VV\_TM\_REQ 34](#_Toc525037234)

[Figuur 12 XSD VV\_TM\_RES 35](#_Toc525037235)

[Figuur 13 XSD KV17cvlinfo 35](#_Toc525037236)

[Figuur 14 XSD KV17JOURNEY 35](#_Toc525037237)

[Figuur 15 XSD KV17MUTATEJOURNEY 36](#_Toc525037238)

[Figuur 16 XSD KV17MUTATEJOURNEYSTOP 36](#_Toc525037239)

[Figuur 17 XSD CANCEL 37](#_Toc525037240)

[Figuur 18 XSD RECOVER 37](#_Toc525037241)

[Figuur 19 XSD SHORTEN 37](#_Toc525037242)

[Figuur 20 XSD LAG 38](#_Toc525037243)

[Figuur 21 XSD CHANGEPASSTIMES 38](#_Toc525037244)

[Figuur 22 XSD CHANGEDESTINATION 38](#_Toc525037245)

[Figuur 23 XSD MUTATIONMESSAGE 39](#_Toc525037246)

[Figuur 24 Koppelvlak protocol stapel 40](#_Toc525037247)

[Figuur 25 HTTP POST protocol berichten uitwisseling 41](#_Toc525037248)

[Figuur 26 Relatie tussen koppelvlak 1, DATEDVEJOPASS en koppelvlak 17
45](#_Toc525037249)

1.  <span id="_Toc222833822" class="anchor"><span id="_Toc525037154" class="anchor"></span></span>Introductie
    =========================================================================================================

    1.  <span id="_Toc222833823" class="anchor"><span id="_Toc525037155" class="anchor"></span></span>Doel en korte beschrijving van het koppelvlak
        -------------------------------------------------------------------------------------------------------------------------------------------

Dit hoofdstuk beschrijft doel en gebruik van het koppelvlak.

### <span id="_Toc222833824" class="anchor"><span id="_Toc525037156" class="anchor"></span></span>Mutaties op het operationeel proces (koppelvlak 17)

Het doel van koppelvlak 17 is om afnemende systemen te voorzien van
informatie over ***ingrepen in het exploitatie proces***, gedefinieerd
ten opzichte van de geplande dienstregeling, zoals gecommuniceerd door
middel van koppelvlak 1. Door middel van koppelvlak 17 kan informatie,
die voortkomt uit CVL ingrepen, gecommuniceerd worden aan de reiziger.

### <span id="_Toc222833826" class="anchor"><span id="_Toc525037157" class="anchor"></span></span>Koppelvlak leveranciers

Koppelvlak 17 informatie wordt geleverd door een vervoerder.

### <span id="_Toc222833827" class="anchor"><span id="_Toc525037158" class="anchor"></span></span>Koppelvlak afnemers

Afnemers van koppelvlak 17 zijn Integrators van zowel het type
presentatieserver als het type integratieserver.

<span id="_Toc222833830" class="anchor"><span id="_Toc525037159" class="anchor"></span></span>Overwegingen en aannamen bij ontwerp koppelvlak 17
------------------------------------------------------------------------------------------------------------------------------------------------

Ter illustratie van de scope van het operationeel proces, volgt hier een
beschrijving van het vervoerproces. Zie figuur 1.

**Stap 1: Planvorming**

Het vervoerproces begint met een vervoerplan dat uitgewerkt wordt in een
dienstregeling. Deze dienstregeling wordt vooraf gecommuniceerd door
middel van BISON koppelvlak 1 (Dienstregeling).

**Stap 2: Voorbereiding exploitatieproces**

Vervolgens worden de te rijden ritten gegroepeerd in uit te voeren
diensten en omlopen.

Daarbij wordt ook het capaciteitsaspect in ogenschouw genomen: op welke
ritten overschrijdt het aanbod van reizigers de capaciteit van het
voertuig. Op deze ritten worden extra voertuigen ingezet, deze extra
ritten noemt men versterkingsritten.

De diensten worden in een rooster gezet waaraan personeel gekoppeld
wordt (bijvoorbeeld chauffeur, machinist, enz.). Vervolgens wordt er
gemuteerd op de inzet van personeel, de diensten waar nodig bijgeschaafd
en omleidingsinformatie voor tijdelijke geplande omleidingen vastgelegd.
Deze informatie kan worden gecommuniceerd[^1] met externe partijen.

**Stap 3: Het exploitatieproces**

Het exploitatie proces, het op een dag uitvoeren van de voor die dag
beloofde dienstregeling, start als de voorbereiding is afgesloten, enige
uren voor de uitruk van het eerste voertuig.

In het exploitatieproces krijgt het personeel een voertuig (al of niet
toegewezen) en voert de ritten van zijn dienst uit. Waar dit teveel
afwijkt van de planning stuurt de (centrale) verkeersleiding bij. Deze
bijsturing kan o.a. bestaan in:

1.  Het wijzigen van de dienst van het personeel

2.  Het wijzigen van een omloop

3.  Het vervangen van een defect voertuig

4.  Het inkorten van ritten

5.  Het laten vervallen van ritten

6.  Het regelen van overstappen i.v.m. een vertraging

7.  Het ingrijpen t.b.v. de regelmaat bij hoog frequente lijnen

8.  Het inleggen van een extra voertuig op een rit (versterkingsrit)

Middels koppelvlak 17 worden ingrepen die betrekking hebben op de
uitvoering van de ritten gecommuniceerd. Het betreft hierbij punten 4
t/m 7 van hierboven genoemde bijsturingen. Daarbij komt een methode om
een gecommuniceerde ingreep ongedaan te maken.

<span id="_Toc525037224" class="anchor"></span>Figuur 1 Schematisch
vervoerproces

<span id="_Toc222833828" class="anchor"><span id="_Toc222833831" class="anchor"><span id="_Toc525037160" class="anchor"></span></span></span>Doel en uitgangspunten van het koppelvlak
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Koppelvlak 17 maakt integraal deel uit van de overkoepelende TMI8
architectuur, welke het beschrijven van de gehele informatieketen voor
OV reisinformatie tot doel heeft. Binnen TMI8 heeft koppelvlak 17 tot
doel het communiceren van informatie over situaties die zich voordoen
als gevolg van ingrepen door de vervoerder (vaak (Centrale)
Verkeersleiding) op het operationele proces. Dit houdt in:

1.  Het laten vervallen van geplande en/of actuele ritten

2.  Het inkorten van een rit

3.  Het uitstellen van het vertrek van een geplande passage

4.  Het aanpassen van eigenschappen van passages, zoals de geplande
    aankomst- en/of vertrektijden en de bestemming van de
    passerende rit.

5.  Herstellen van een rit of een passage naar de originele staat zoals
    aangeleverd volgens de dienstregeling.

Koppelvlak 17 is ontwikkeld onder de volgende aannames:

1.  Informatie aangeleverd door het koppelvlak wordt gebruikt om in
    reisinformatie te voorzien.

2.  Koppelvlak 17 is gebaseerd op de passage van een rit
    als basiseenheid.

3.  Met een rit wordt bedoeld: een gedateerde wagenrit.

4.  Met een passage wordt bedoeld: een halte waar de rit volgens
    planning kan halteren. Het kan zijn dat een rit volgens de
    dienstregeling vaker dan één maal halteert bij dezelfde halte – dit
    wordt aangegeven met een passeernummer (PassageSequenceNumber).

5.  Koppelvlak 17 berichten refereren aan een gedateerde wagenrit, die
    door de Integrator worden afgeleid uit een eerder
    aangeleverde dienstregeling.

6.  Koppelvlak 17 is niet bedoeld als instrument voor het communiceren
    van omleidingen en/of dagplannen.

7.  Koppelvlak 17 berichten kunnen alleen betrekking hebben op eerder
    door middel van koppelvlak 1 gecommuniceerde routes; er kunnen geen
    routes en/of route-elementen aan de koppelvlak 1 dataset worden
    toegevoegd door middel van koppelvlak 17

8.  Koppelvlak 17 berichten hebben uitsluitend betrekking op het
    operationele exploitatieproces.

9.  Het inleggen, laten vervallen en/of het muteren van
    versterkingsritten maakt op dit moment geen onderdeel uit van
    koppelvlak 17.

    1.  Plaats van de koppelvlak in het model
        -------------------------------------

Koppelvlak 17 maakt deel uit van zowel het integratiemodel als het
presentatiemodel, zoals gehanteerd in de BISON werkgroepen en zoals
weergegeven in de KpVV-publicatie ‘Voorbeelden voor besteksteksten’
(januari 2008), in respectievelijk de figuren 5 (pag. 21) en 4 (pag. 20)
aldaar. Uitwisseling van koppelvlak 17 berichten vindt plaats tussen het
aanleverende **vervoerder-** en **integratie**systeem, zie figuur 2.

<span id="_Ref224628317" class="anchor"><span id="_Toc525037225"
class="anchor"></span></span>Figuur 2 Plaats van koppelvlak 17

Globale procesbeschrijving 
---------------------------

Koppelvlak 17 communiceert (met als basis koppelvlak 1) een afspiegeling
van het vervoersproces ten aanzien van mutaties in de exploitatie van
een geplande rit. Koppelvlak 1 is een verzameling (door de vervoerder)
geplande ritten. Een koppelvlak 17 bericht beschrijft mutaties op
eigenschappen van een rit, en van haltes binnen een rit. Een koppelvlak
17 bericht heeft altijd een bijbehorende geplande rit in koppelvlak 1.

Koppelvlak 17 ondersteunt de volgende ingrepen:

1.  Het laten vervallen van dienstregelingsritten

2.  Het einde van een rit wordt ingekort

3.  Het begin van een rit wordt ingekort

4.  Haltepassages vervallen (als gevolg van bijv. omleiding)

5.  Het aanpassen van de bestemming van een rit

6.  Het aanpassen van geplande aankomst- en vertrektijd van een passage
    op een rit

7.  Het uitstellen van vertrek van een halte (bijv. voor aansluiting op
    ander voertuig)

8.  Het herstellen van deze ingrepen

    1.  ### Algemene scenario’s

Hier volgen een aantal scenario’s die zich op een operationele dag voor
kunnen doen. De hier beschreven scenario’s worden ondersteund door
koppelvlak 17.

**Scenario 1: Het laten vervallen van een rit**

Stap 0: Een rit R~0~ is gepland in de dienstregeling. Eventueel is deze
rit reeds actief geworden.

Stap 1: De CVL besluit de geplande rit niet te laten rijden.

Stap 2: Zij wil de afnemende partij laten weten dat ‘rit R~0~ vervalt’.

Stap 3: Zij verstuurt via koppelvlak 17 een CANCEL bericht voor rit
R~0~.

**Scenario 2: Het einde van een rit wordt ingekort**

Stap 0: Een rit R~0~ is gepland in de dienstregeling. Onderdeel van de
beschrijving van de rit is de sequentie haltes welke op deze rit
aangedaan zal worden. Voor rit R~0~ zijn dat 10 haltes, H~0~, …, H~9~.
De bestemming van de rit is B~0~.

Stap 1: De vervoerder besluit voor deze rit de laatste 3 haltes (H~7~,
H~8~, H~9~) te laten vervallen. Hiermee wijzigt de bestemming in B~1~;
halte H~6~ is nu de eindhalte.

Stap 2: Zij stuurt 3 koppelvlak 17 SHORTEN berichten, één per vervallen
halte, met de mededeling ‘deze halte vervalt voor rit R~0~’. Tevens
stuurt zij 6 koppelvlak 17 CHANGEDESTINATION berichten naar de overige
haltes die wel aangedaan worden. Dit communiceert voor haltes H~0~ t/m
H~5~ de nieuwe bestemming B~1~.

**Scenario 3: Het begin van een rit wordt ingekort**

Stap 0: Een rit R~0~ is gepland in de dienstregeling. Onderdeel van de
beschrijving van de rit is de sequentie haltes welke op deze rit
aangedaan zal worden. Voor rit R~0~ zijn dat 10 haltes, H~0~, …, H~9~.
De bestemming van de rit is B~0~.

Stap 1: De vervoerder besluit voor deze rit de eerste 3 haltes (H~0~,
H~1~, H~2~) te laten vervallen. Verder wijzigt er niets aan de rit.

Stap 2: Zij stuurt 3 koppelvlak 17 SHORTEN berichten naar de vervallen
haltes, met de mededeling ‘deze halte vervalt voor rit R~0~’. Tevens
stuurt zij een koppelvlak 17 CHANGEPASSTIMES bericht naar halte H~3~ en
wordt op de halte alleen nog de vertrektijd getoond.

**Scenario 4: Haltepassages op een rit vervallen (omleiding) **

Stap 0: Een rit R~0~ is gepland in de dienstregeling. Onderdeel van de
beschrijving van de rit is de sequentie haltes welke op deze rit
aangedaan zal worden. Voor rit R~0~ zijn dat 10 haltes, H~0~, …, H~9~.
De bestemming van de rit is B~0~.

Stap 1: Doordat een omleiding/afwijkende planning wordt gereden, worden
enkele geplande haltes (H~4~, H~5,~ H~6~) niet aangedaan.

Stap 2: De vervoerder communiceert de wijziging via 3 koppelvlak 17
SHORTEN berichten naar de vervallen haltes. Het KV17 SHORTEN bericht
wordt vertaald in de KV8 TripStopStatus ‘CANCEL’.

Om de reizigers bij de vervallen haltepassages t.o.v. de planning te
bedienen, worden veelal alternatieve/vervangende haltes ingesteld. Deze
vervangende haltes bij een omleiding kunnen nog niet via KV17 worden
doorgegeven.

**Scenario 5: Eigenschappen van een passage worden aangepast**

Stap 0: Een rit R~0~ is gepland in de dienstregeling. Onderdeel van R~0~
maakt uit de passage van halte H~n~. H*~n~* is in de planning opgenomen
met aankomsttijd t~a~ en vertrektijd t~v~.

Stap 1: De vervoerder besluit dat de geplande tijden door omstandigheden
niet langer relevant zijn. In plaats daarvan gelden de nieuwe geplande
tijden t~a2~ en t~v2~.

Stap 2: Zij stuurt een koppelvlak 17 CHANGEPASSTIMES bericht naar de
afnemer met de mededeling: ‘voor rit R~0~ gelden op H~n~ de nieuwe
geplande tijden t~a2~ en t~v2~’. Het CHANGEPASSTIMES bericht wordt
vertaald in een aangepaste geplande aankomst- en vertrektijd in
koppelvlak 8. De stiptheid in koppelvlak 6 dient nu gerelateerd te
worden aan deze aangepaste geplande tijden.

**Scenario 6: Het vertrek van een voertuig op een halte wordt
uitgesteld**

Stap 0: Een rit R~0~ is gepland in de dienstregeling. Deze rit zal van
halte H~n~ vertrekken om t~v~.

Stap 1: De CVL besluit dat R~0~ op halte H*~n~* twee minuten langer zal
moeten wachten om een aansluiting met een ander voertuig mogelijk te
maken.

Stap 2: Zij communiceert middels een koppelvlak 17 LAG bericht met de
afnemer: ‘rit R~0~ wacht 2 minuten langer op halte H*~n~*’. De
betreffende halte wordt nu behandeld als tijdhalte.

**Scenario 7: Een eerder gecommuniceerde ingreep wordt ongedaan
gemaakt**

Stap 0: Een rit R~0~ is gepland in de dienstregeling en door middel van
koppelvlak 1 gecommuniceerd met de afnemende partij.

Stap 1: Op tijdstip t~0~ communiceert de CVL één van de hier boven
geschreven ingrepen, gedaan op rit R~0~. Even later, op tijdstip t~1~,
besluit zij de eerder gedane ingreep ongedaan te maken.

Stap 2: Zij stuurt dan een koppelvlak 17 RECOVER bericht naar de afnemer
met de mededeling ‘rit R~0~ rijdt weer zoals gepland’.

**Scenario 8: Toelichting bij mutatie**

Stap 0: Een rit R~0~ is gepland in de dienstregeling en door middel van
koppelvlak 1 gecommuniceerd met de afnemende partij.

Stap 1: Op enig moment besluit de CVL tot het inkorten van rit R~0~,
zoals beschreven scenario 3. Zij wil dit besluit communiceren, met
bijgaand een toelichting voor de reiziger dat deze inkorting het gevolg
is van het momenteel plaatsvindende Bloemencorso.

Stap 2: Zij stuurt dan een koppelvlak 17 bericht dat de gewenste mutatie
communiceert, en laat deze vergezeld gaan van een koppelvlak 17
MUTATIONMESSAGE bericht, waarin zij de oorzaak bekend maakt als het
Bloemencorso.

### Technische opmerkingen

Door middel van een CANCEL kan iedere in koppelvlak 1 geplande
dienstregelingsrit als actieve rit worden geschrapt. Dit bericht kan
verstuurd worden als de rit nog niet begonnen is, en/of als de rit al
wel begonnen is.

Normaliter zal een vervallen rit of haltepassage nog steeds op de
betreffende haltedisplay getoond worden met de toevoeging ‘vervallen’.
Wanneer echter een groot aantal ritten tegelijk vervalt (bijv. bij
stakingen of extreme weersomstandigheden) kan het de voorkeur hebben de
vervallen ritten *niet* meer te tonen, maar alleen de nog wel te
verwachten ritten. Dit gedrag wordt aangestuurd d.m.v. de indicator
ShowCancelledTrip in de CANCEL, SHORTEN en MUTATIONMESSAGE berichten.

Let op: bij een SHORTEN of MUTATIONMESSAGE moet deze indicator worden
gezet bij *elke* niet meer te tonen haltepassage!

Koppelvlak 17 ondersteunt ook mutaties op eigenschappen van haltes die
gedurende de actieve rit gepasseerd worden. Het gaat hier om het
aanpassen van geplande vertrek- en aankomsttijden, bestemming van de
passerende rit, en het laten tonen van aankomst- en/of vertrektijden ten
behoeve van een begin-, tussen- of eindhalte. Dit wordt met
CHANGEPASSTIMES of CHANGEDESTINATION berichten gecommuniceerd.

Het SHORTEN bericht heeft betrekking op een individuele halte, en geeft
aan dat de betreffende halte niet langer door de rit zal worden
aangedaan.

Met een LAG bericht wordt het vertrek van een voertuig van een passage
uitgesteld met een gedefinieerde tijd. Dit wordt in het algemeen
gebruikt indien er een gegarandeerde aansluiting op een vertraagde rit
wordt gegeven. De halte wordt (voor de betreffende passage) behandeld
als tijdhalte, d.w.z. de nieuwe verwachte vertrektijd geldt als vaste
prognosetijd. Er wordt alleen een LAG bericht gestuurd voor de halte
waar gewacht zal worden, *niet* voor de overige haltes van de rit. De
ontvanger van het LAG bericht kan desgewenst zelf wel voor die
vervolghaltes aangepaste passagetijden afleiden uit de geplande
vertraging op de LAG halte.

Een LAG bericht kan voor elke halte van een rit gegeven worden.

Een RECOVER bericht herstelt eerdere ingrepen tot de situatie zoals deze
al eerder gepland was. Een RECOVER bericht verstuurd na een CANCEL, doet
de eerder geplande rit weer rijden, wat bijvoorbeeld van toepassing is
wanneer een rit onbedoeld geCANCELed is.

Er bestaat ook de mogelijkheid om door middel van koppelvlak 17 te
communiceren over oorzaken en/of adviezen aangaande mutaties. Dit kan op
twee manieren: op ritniveau, bij een CANCEL bericht – dan zijn de
teksten bedoeld voor in principe alle haltes die bij de rit betrokken
zijn. Ook kan een MUTATIONMESSAGE worden gestuurd, die binnen een
bepaalde rit een bepaalde halte adresseert.

Koppelvlak 17 berichten kunnen niet gestapeld worden – dit betekent dat
voor dezelfde rit alle vigerende wijzigingen in één dossier moeten
worden gecommuniceerd. Ook als er daarna voor dezelfde rit nieuwe
wijzigingen plaats vinden, moet de nieuwe situatie in één keer
gecommuniceerd worden. Mutaties hebben dus geen geschiedenis; het is
niet mogelijk om incrementeel wijzigingen door te geven.

Merk op dat dit onder meer tot gevolg heeft dat het volgende scenario
mogelijk is:

1.  Een rit R~0~ is gepland in de dienstregeling

2.  De CVL besluit de rit te laten vervallen en stuurt een CANCEL(rit
    R~0~) bericht

3.  Even later ontvangt de Integrator een CHANGEPASSTIMES voor een halte
    op de geplande rit R~0~.

4.  De Integrator concludeert: rit R~0~ rijdt toch weer geheel conform
    planning, uitgezonderd de ene CHANGEPASSTIMES.

Dit is het gevolg van het feit dat berichten niet gestapeld kunnen
worden: het laatste bericht over rit R~0~ communiceert altijd de actuele
status van deze rit!

### Haltes

Binnen koppelvlak 17 wordt een halte op één manier geïdentificeerd,
namelijk zoals in het systeem van de vervoerder aangegeven
(UserStopCode). Dit kan dus per vervoerder verschillen. Een integrator
normaliseert zonodig de haltes van de verschillende vervoerders.

### Haltepassages

Een haltepassage op een publieksrit wordt geïdentificeerd aan de hand
van de halte en het aantal

geplande stops op die halte. Binnen koppelvlak 17 zijn dit de attributen
UserStopCode en

PassageSequenceNumber, waarbij PassageSequenceNumber staat voor de
passage volgorde: eerste

passage, tweede passage, derde passage. Een PassageSequenceNumber begint
bij 0 en wordt

verhoogd met 1 voor elke geplande passage voor dezelfde halte. Merk op
dat deze wijze van

identificatie van een haltepassage afwijkt van identificatie van een
haltepassage in koppelvlak 1, waar

UserStopOrderNumber of TiminglinkOrderNumber gebruikt wordt als
haltepassage identificatie op

rit niveau. Voor meer informatie zie hoofdstuk 3.2.

1.  <span id="_Toc222833832" class="anchor"><span id="_Toc525037167" class="anchor"></span></span>Bericht definities
    ================================================================================================================

    1.  <span id="_Toc222833833" class="anchor"><span id="_Toc525037168" class="anchor"></span></span>Legenda
        -----------------------------------------------------------------------------------------------------

  Legenda
  ---------------------------------------------------------------------------- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Soort – geeft soort veld aan**
  \#
  X
  O
  O\#
  XR
  OR
  **Type – geeft type veld aan**
  V\#
  N\#
  Z\#
  E\#
  X..Y
  S\#
  B
  D
  T
  U
  **Sleutel – geeft soort sleutel aan**
  P
  1..9
  U
  **Standaard – geeft aan in welke standaard(s) het element gebruikt wordt**
  &lt;X
  X
  +X
  **Overig**
  Deprecated
  OBJECTNAME

<span id="_Toc525037205" class="anchor"></span>Tabel 1 Legenda

<span id="_Toc222833835" class="anchor"><span id="_Toc525037169" class="anchor"></span></span>Gebruik van enumeraties en tabellen
---------------------------------------------------------------------------------------------------------------------------------

Ten aanzien van controles op in de tabellen beschreven waardes is het
volgende van belang voor het afnemend systeem:

> Voor de tabellen gemarkeerd met ENUM geldt dat de elementen alleen de
> genoemde waardes mag bevatten (limitatief). Een andere waarde dan de
> genoemde waarde moet leiden tot het afkeuren van het bericht, de
> waarde is nm syntactisch incorrect. Een verandering (toevoeging of
> verwijdering) van een tabel gemarkeerd met ENUM leidt altijd tot een
> verandering in de applicatie.
>
> Tabellen gemarkeerd met RANGE zijn niet limitatief. Verandering in
> deze tabellen leiden alleen tot applicatie wijzigingen indien de
> applicatie gebruik wil gaan maken van een nieuwe waarde. Bestaande
> applicaties die een voor de applicatie onbekende waarde ontvangen
> mogen deze waarde negeren, de waarde is nm syntactisch correct.

De binnen het koppelvlak gebruikte enumeraties en tabellen kunnen
gevonden worden in het document “BISON Enumeraties en Tabellen”,
beschikbaar op de BISON website
([http://bison.connekt.nl](http://bison.connekt.nl/)). Dit geldt voor
alle datatypes (\*TYPE) zoals in de tabellen genoemd.

Tabellen
--------

Dit hoofdstuk bevat de bericht definities van de berichten of berichten
die in het koppelvlak gebruikt worden.

### Interpretatie gebruikte tabel

  **OBJECTNAME**   Omschrijving
  ---------------- -------------- -------- ----------- -------------- ---------------------------------
  Element          > Soort
  VeldNaam         

<span id="_Toc525037206" class="anchor"></span>Tabel 2 Definitie object
tabel

### Berichten

De berichten zijn onderdeel van het KV17cvlinfo dossier.

  **CANCEL**            Laat een dienstregelingsrit vervallen (ReinforcementNumber is altijd 0). Merk op dat CANCEL op ritniveau werkt, dus voor alle haltes die op deze rit aangedaan zou worden. Daarom heeft CANCEL een eigen mogelijkheid om oorzaak- en advies te specificeren.
  --------------------- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ----------- ------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------
  Element               > Soort
  DataOwnerCode         \#
  LinePlanningNumber    \#
  OperatingDay          \#
  JourneyNumber         \#
  ReinforcementNumber   \#
  Timestamp             X
  ReasonType            O1
  SubReasonType         O1
  ReasonContent         O
  AdviceType            O2
  SubAdviceType         O2
  AdviceContent         O
  ShowCancelledTrip     X

<span id="_Toc525037207" class="anchor"></span>Tabel 3 CANCEL (laat een
rit vervallen)

  **SHORTEN**             Laat haltepassage op een rit vervallen
  ----------------------- ---------------------------------------- -------- ----------- ------------------------------------------------------------------------------------------------------------------------------------------------- -----------------------
  Element                 > Soort
  DataOwnerCode           \#
  LinePlanningNumber      \#
  OperatingDay            \#
  JourneyNumber           \#
  ReinforcementNumber     \#
  Timestamp               X
  UserStopCode            \#
  PassageSequenceNumber   \#
  ShowCancelledTrip       X

<span id="_Toc525037208" class="anchor"></span>Tabel 4 SHORTEN (laat
passage op een rit vervallen)

  **RECOVER**           Zet een rit terug naar de geplande waardes volgens koppelvlak 1.
  --------------------- ------------------------------------------------------------------ -------- ----------- ----------------------------------------------------------------------- ---------------------
  Element               > Soort
  DataOwnerCode         \#
  LinePlanningNumber    \#
  OperatingDay          \#
  JourneyNumber         \#
  ReinforcementNumber   \#
  Timestamp             X

<span id="_Toc525037209" class="anchor"></span>Tabel 5 RECOVER (herstelt
eerdere ingrepen)

  **ADD**   Gereserveerd
  --------- -------------- -------- ----------- -------------- ---------
  Element   > Soort

<span id="_Ref225658581" class="anchor"><span id="_Toc525037210"
class="anchor"></span></span>Tabel 6 ADD (gereserveerd)

  **LAG**                 Stelt vertrek van specifieke passage bepaalde tijd uit
  ----------------------- -------------------------------------------------------- -------- ----------- ------------------------------------------------------------------------ -----------------------
  Element                 > Soort
  DataOwnerCode           \#
  LinePlanningNumber      \#
  OperatingDay            \#
  JourneyNumber           \#
  ReinforcementNumber     \#
  Timestamp               X
  UserStopCode            \#
  PassageSequenceNumber   \#
  LagTime                 X

<span id="_Toc525037211" class="anchor"></span>Tabel 7 LAG (Stelt
vertrek van specifieke passage bepaalde tijd uit)

  **CHANGEPASSTIMES**     Pas de geplande aankomst- en vertrektijd van een passage aan voor een specifieke rit
  ----------------------- -------------------------------------------------------------------------------------- -------- ----------- ------------------------------------------------------------------------------------------------------------------------------------------------------- -----------------------
  Element                 > Soort
  DataOwnerCode           \#
  LinePlanningNumber      \#
  OperatingDay            \#
  JourneyNumber           \#
  ReinforcementNumber     \#
  Timestamp               X
  UserStopCode            \#
  PassageSequenceNumber   \#
  TargetArrivalTime       X
  TargetDepartureTime     X
  JourneyStopType         X

<span id="_Toc525037212" class="anchor"></span>Tabel 8 CHANGEPASSTIMES
(verandert geplande aankomst- en vertrektijden van passage)

  **CHANGEDESTINATION**   Pas de bestemming van een rit aan op een bepaalde passage
  ----------------------- ----------------------------------------------------------- -------- ----------- ------------------------------------------------------------------------ -----------------------
  Element                 > Soort
  DataOwnerCode           \#
  LinePlanningNumber      \#
  OperatingDay            \#
  JourneyNumber           \#
  ReinforcementNumber     \#
  Timestamp               X
  UserStopCode            \#
  PassageSequenceNumber   \#
  DestinationCode         O
  DestinationName50       X
  DestinationName16       X
  DestinationDetail16     O
  DestinationDisplay16    O

<span id="_Toc525037213" class="anchor"></span>Tabel 9 CHANGEDESTINATION
(verandert bestemming van passerende rit)

  **MUTATIONMESSAGE**     Communiceert toelichting (oorzaak, advies) op mutatie voor een specifieke halte
  ----------------------- --------------------------------------------------------------------------------- -------- ----------- ------------------------------------------------------------------------------------------------------------------------------------------------- -----------------------
  Element                 > Soort
  DataOwnerCode           \#
  LinePlanningNumber      \#
  OperatingDay            \#
  JourneyNumber           \#
  ReinforcementNumber     \#
  Timestamp               X
  UserStopCode            \#
  PassageSequenceNumber   \#
  ReasonType              O1
  SubReasonType           O1
  ReasonContent           O
  AdviceType              O2
  SubAdviceType           O2
  AdviceContent           O
  ShowCancelledTrip       O

<span id="_Toc525037214" class="anchor"></span>Tabel 10 MUTATIONMESSAGE
(communiceert oorzaak en/of advies voor reiziger)

### <span id="_Toc230402542" class="anchor"><span id="_Toc525037173" class="anchor"></span></span>Interactie tussen Koppelvlak 17 en andere Koppelvlakken

Onderstaande tabel geeft het effect van het optreden van een gebeurtenis
in koppelvlak 17 op de TripStopStatus in koppelvlak 8 en op het display
(reizigers informatie).

  Koppelvlak 17       Koppelvlak 8                   Reden om display bij te werken
  ------------------- ------------------------------ ------------------------------------------------------------------
  BERICHT             DATEDPASSTIME TRIPSTOPSTATUS   
  CANCEL              CANCEL                         Rit vervallen
  RECOVER             PLANNED                        Nog niet actieve rit wordt hersteld
                      DRIVING                        Reeds actieve rit wordt hersteld
  SHORTEN             CANCEL                         Rit komt niet op betreffende halte i.v.m. vervallen haltepassage
  CHANGEPASSTIMES     &lt;niet van invloed&gt;       Geplande aankomst- en/of vertrektijd aangepast.
  CHANGEDESTINATION   &lt;niet van invloed&gt;       Bestemming aangepast.
  LAG                 &lt;niet van invloed&gt;       Aangepaste verwachte vertrektijd
  MUTATIONMESSAGE     &lt;niet van invloed&gt;       Tekstuele informatie voor reiziger

<span id="_Ref228632785" class="anchor"><span id="_Toc230402594"
class="anchor"><span id="_Toc525037215"
class="anchor"></span></span></span>Tabel 11 Interactie Koppelvlak 17 en
Koppelvlak 8

Of een ritstatus in koppelvlak 8 PLANNED of DRIVING wordt, hangt ervan
af of de rit al geïnitialiseerd is door middel van koppelvlak 6 of
koppelvlak 19.

Een CHANGEPASSTIMES bericht wordt vertaald in een aangepaste geplande
aankomst- en vertrektijd in koppelvlak 8. De verwachte tijden in
koppelvlak 8 worden berekend op basis van de geplande aankomst- en
vertrektijden uit CHANGEPASSTIMES en de stiptheid (Punctuality) uit
koppelvlak 6.

De stiptheid in koppelvlak 6 (Punctuality) wordt na verwerking van
CHANGEPASSTIMES gerelateerd aan de *gewijzigde* geplande aankomst- en
vertrektijd, niet meer aan de oorspronkelijke tijden uit koppelvlak 1.

Het effect van LAG bericht is dat de betreffende halte wordt behandeld
als een tijdhalte, d.w.z. de verwachte vertrektijd geldt als een vaste
prognosetijd. Indien een rit vroeger arriveert op deze halte, wordt er
in de reisinformatie vanuit gegaan dat de rit blijft wachten tot de
verwachte vertrektijd. Een koppelvlak 6 ARRIVED bericht op een halte,
waarvoor een LAG is verstuurd, resulteert dus niet in een aangepaste
verwachte vertrektijd, tenzij het ARRIVED bericht is verstuurd ná de
verwachte vertrektijd.

De waarde van ShowCancelledTrip in koppelvlak 8 DATEDPASSTIME wordt
overgenomen uit het bijbehorende koppelvlak 17 CANCEL, SHORTEN of
MUTATIONMESSAGE bericht.

<span id="_Ref242727598" class="anchor"><span id="_Toc525037174" class="anchor"></span></span>Entity Relationship Diagrammen (ERD)
----------------------------------------------------------------------------------------------------------------------------------

Er is geen directe relatie te tussen koppelvlak 17 en koppelvlak 1. Wel
is er een indirecte relatie, de koppelvlak 17 berichten moeten immers
gerelateerd kunnen worden aan de planning, zoals deze in koppelvlak 1
beschreven staat. Maar binnen koppelvlak 17 missen een aantal
sleutelvelden welke binnen koppelvlak 1 wel nodig zijn. Het is dus niet
mogelijk een ERD voor koppelvlak 17 op te stellen.

Om de lezer, en dan met name de programmeur, tegemoet te komen is in
*Bijlage 4: Voorbeeld technische koppeling tussen koppelvlak 17 en
koppelvlak 1* een mogelijk voorbeeld beschreven van een indirecte
koppeling tussen koppelvlak 17 en koppelvlak 1.

Hieraan kunnen geen rechten ontleend worden, het is slechts een
voorbeeld.

1.  <span id="_Toc222833844" class="anchor"><span id="_Toc525037175" class="anchor"></span></span>Semantiek en Achtergronden
    ========================================================================================================================

    1.  <span id="_Toc222833845" class="anchor"><span id="_Toc525037176" class="anchor"></span></span>Business regels specifiek voor koppelvlak 17
        ------------------------------------------------------------------------------------------------------------------------------------------

In het gebruik van koppelvlak 17 gelden de volgende business regels:

1.  In koppelvlak 17 heeft een rit altijd ReinforcementNumber = 0.

2.  Het inkorten van een rit ‘aan de achterkant’ (de laatste halte(s)
    van de rit vervalt/vervallen) leidt er toe dat de bestemming van een
    rit wijzigt. Met een CHANGEDESTINATION bericht kan voor de haltes
    die niet vervallen de bestemming gewijzigd worden.

3.  Een vervallen rit wordt doorgegeven met een CANCEL zodat afnemende
    systemen kunnen vaststellen of de gehele rit vervalt of slechts een
    deel van de rit door een inkorting of omleiding.

4.  Het sturen van een RECOVER bericht voor een rit die eerder is
    gepland, leidt ertoe dat de eigenschappen van deze rit teruggezet
    worden naar die zij in de planning had.

5.  Koppelvlak 17 berichten hebben altijd betrekking op één operationele
    dag; Een Koppelvlak 17 bericht kan op de operationele dag of de
    voorgaande dag worden gestuurd. Op dag *x* kan dus iets
    gecommuniceerd worden over de volgende operationele dag (*x*+1).

6.  Bij gebruik van het CHANGEPASSTIMES bericht is het verplicht
    geplande aankomst- en vertrektijden te specificeren. Ook is het
    nodig om het soort stop op de rit (JourneyStopType) te definiëren:
    is de passage voor deze rit een begin-, tussen- of eindhalte. In het
    geval van een beginhalte is de waarde voor geplande aankomsttijd
    betekenisloos; voor een eindhalte is de waarde voor geplande
    vertrektijd betekenisloos.

7.  Een LAG bericht wordt alleen gestuurd voor de halte waar het vertrek
    wordt uitgesteld en dus niet voor evt. vervolghaltes van de rit.

    1.  <span id="_Ref242728038" class="anchor"><span id="_Toc222833848" class="anchor"><span id="_Ref225346801" class="anchor"><span id="_Ref225346805" class="anchor"><span id="_Toc525037177" class="anchor"></span></span></span></span></span>Gebruik van PassageSequenceNumber 
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Het is mogelijk om een rit zo te plannen dat een voertuig voor dezelfde
publieksrit meer dan eenmaal dezelfde halte aandoet. Voorbeelden zijn
ritten waar begin- en eindhalte dezelfde halte zijn (enkele lus) of waar
een tussenhalte tweemaal aangedaan wordt (dubbele lus). In koppelvlak 1
wordt UserStopOrderNumber en TimingLinkOrderNumber gebruikt om op rit
niveau aan te geven

hoeveelste stop of timingpoint het betreft. Het gebruik van
UserStopOrderNumber en TimingLinkOrderNumber in het voertuigvolgsysteem
versus koppelvlak 1 is niet consistent, wat leidt

tot het mogelijk onterecht afkeuren van koppelvlak 17 berichten.

Om dit probleem op te lossen is PassageSequenceNumber geïntroduceerd.
Gebruik hiervan is als volgt: het voertuig volgsysteem houdt op
ritniveau bij hoe vaak een bepaalde halte aangedaan wordt

en communiceert dit in PassageSequenceNumber. De integrator bepaald aan
de hand van het ontvangen koppelvlak 1 hoe vaak een bepaalde halte op
rit niveau aangedaan wordt. Zowel het

voertuigvolgsysteem als de integrator tellen hierbij vanaf 0, en per
volgende passage voor dezelfde halte en rit wordt de
PassageSequenceNumber met een (1) verhoogd.

Door deze werkwijze is de consistentie gewaarborgd en worden koppelvlak
17 berichten juist en

eenvoudig verwerkt waar anders extra inspanning van de integrator
vereist is om te kunnen bepalen

welke haltepassage de juiste haltepassage is.

Gebruik van Reason- en Advice-codes of –teksten
-----------------------------------------------

Bij mutaties door middel van koppelvlak 17 kan de betrokken CVL er voor
kiezen één of twee begeleidende teksten mee te geven, te weten Reason
en/of Advice. De eerste beschrijft de oorzaak van de mutatie, de tweede
eventueel advies voor de reiziger naar aanleiding van deze mutatie.

Bij een CANCEL bericht kunnen REASON en/of ADVICE worden meegegeven voor
de gehele (vervallen) rit – deze berichten zijn dan geldig voor alle op
de rit actieve haltes. Ook op halteniveau kunnen boodschappen worden
gecommuniceerd, bijvoorbeeld bij vervallen haltes, gewijzigde
vertrektijden of bestemmingen, etc.

Deze boodschappen kunnen op twee manieren worden gecommuniceerd: als een
string van max 255 karakters, en/of als codes conform de SIRI-SX
standaard.

Het is mogelijk om codes te gebruiken om verstoring, genomen maatregel,
effect op de reiziger en advies aan de reiziger te geven. Het voordeel
van het gebruik van codes is de eenduidigheid. Het gebruik van codes
binnen CANCEL en MUTATIONMESSAGE gaat als volgt, waarbij van de volgende
situatie wordt uitgegaan:

> Verstoring: wielerronde
>
> Advies: overstappen in

Uit de tabellen blijken de volgende coderingen:

> Verstoring: pti19,24\_13
>
> Advies: pti211,3\_1

Dit houdt in dat een MUTATIONMESSAGE berichten als volgt gevuld wordt:

> &lt;tmi8:userstopcode&gt;1002&lt;/tmi8:userstopcode&gt;
>
> &lt;tmi8:passagesequencenumber&gt;**0**&lt;/tmi8:passagesequencenumber&gt;
>
> &lt;tmi8:timestamp&gt;2009-01-12T**10:48:00**&lt;/tmi8:timestamp&gt;
>
> &lt;tmi8:reasontype&gt;**1**&lt;/tmi8:reasontype&gt;
>
> &lt;tmi8:subreasontype&gt;**24\_13**&lt;/tmi8:subreasontype&gt;
>
> &lt;tmi8:advicetype&gt;**1**&lt;/tmi8:advicetype&gt;
>
> &lt;tmi8:subadvicetype&gt;**3\_1**&lt;/tmi8:subadvicetype&gt;

Let op: de Code en SubCode moeten altijd gezamenlijk ingevuld worden!

Het ontvangende system draagt zorg voor de vertaling van de code naar
tekst, volgens de eventueel daarvoor afgesproken eisen.

Gebruik van JourneyStopType
---------------------------

Binnen de BISON koppelvlakken wordt het JourneyStopType attribuut
gebruikt om te bepalen welke van de geleverde tijden valide van
toepassing is voor een halte. Zo is het over het algemeen niet
gebruikelijk om op een beginhalte de aankomsttijd van een passage te
tonen of op een eindhalte de vertrektijd. Voor een tussenhalte zijn
zowel aankomst- als vertrektijd van toepassing. Voor het gebruik van het
JourneyStopType attribuut wordt verwezen naar tabel 12.

  JourneyStopType   Aankomsttijd    Vertrektijd     Gedrag op de halte
  ----------------- --------------- --------------- ------------------------------------
  FIRST             valide waarde   valide waarde   Gebruik de vertrektijd
  INTERMEDIATE      valide waarde   valide waarde   Gebruik aankomst en/of vertrektijd
  LAST              valide waarde   valide waarde   Gebruik de aankomsttijd

<span id="_Ref242787490" class="anchor"><span id="_Toc525037216"
class="anchor"></span></span>Tabel 12 Gebruik van JourneyStopType

Toestanden (states) in koppelvlak 17
------------------------------------

Koppelvlak 17 is toestandsloos: de enige bekende toestand is die zoals
gecommuniceerd in de planning. Het laatst ontvangen koppelvlak 17
bericht communiceert altijd de actuele situatie, ten opzichte van deze
planning. Als een rit 20 haltes aandoet en er voor één halte een mutatie
ontvangen wordt, verandert er niets aan (de planning van) de overige 19
haltes.

<span id="_Toc222833850" class="anchor"><span id="_Ref223930825" class="anchor"><span id="_Ref223930937" class="anchor"><span id="_Ref223930947" class="anchor"><span id="_Toc525037181" class="anchor"></span></span></span></span></span>Het verwerken van koppelvlak berichten
=================================================================================================================================================================================================================================================================================

Dit hoofdstuk beschrijft hoe de koppelvlak berichten verwerkt kunnen
worden.

Koppelvlak scenario’s
---------------------

Het afnemend systeem ontvangt en verzendt berichten. Dit hoofdstuk
beschrijft het typisch gebruik van deze berichten aan de hand van UML
sequentie diagrammen. De berichten worden aan de hand van de
onderstaande scenario’s beschreven, optionele berichten in de figuren
zijn te herkennen aan het *schuinschrift*:

1.  Een geplande of actieve rit vervalt

2.  Een eerder vervallen geplande rit zal toch rijden

3.  Eerste halte van een rit vervalt

4.  Laatste halte van een rit vervalt en bestemming wijzigt

5.  Vertrektijden op één halte worden 5 minuten uitgesteld

6.  Halte op rit krijgt andere geplande aankomst- en vertrektijd

7.  Een vervallen rit moet niet meer getoond worden

NB: op alle plaatsen waar sprake is van een versterkingsnummer
(ReinforcementNumber), dient hiervoor waarde 0 ingevuld te worden.
Waardes hoger dan 0 refereren aan versterkingsritten, en die worden
momenteel niet in koppelvlak 17 ondersteund.

### <span id="_Ref225327210" class="anchor"><span id="_Toc525037183" class="anchor"></span></span>Scenario 1: een geplande of actieve rit vervalt

Het communiceren van het vervallen van een dienstregeling rit gebeurt
met het CANCEL bericht. Bij het laten vervallen van een rit maakt het
niet uit of er een voertuigkoppeling (zie koppelvlakken 6 en 19) heeft
plaatsgevonden, het effect is gelijk.

Het effect van het bericht is dat aan de integrator gecommuniceerd wordt
dat de betreffende rit niet gereden zal worden.

<span id="_Toc525037226" class="anchor"></span>Figuur 3 Scenario 1: Een
geplande of actieve rit vervalt

### Scenario 2: Een eerder vervallen rit zal toch rijden

Als een rit, waarvoor eerder is gecommuniceerd dat deze vervallen is
(CANCEL), toch blijkt te gaan rijden, kan hiervoor een RECOVER gestuurd
worden. De rit wordt dan ingepland / voortgezet als in de planning
beschreven.

Het effect van het bericht is dat aan de integrator gecommuniceerd wordt
dat de betreffende rit gereden zal worden.

<span id="_Toc525037227" class="anchor"></span>Figuur 4 Scenario 2: Een
eerder vervallen rit zal toch rijden

### <span id="_Ref241472035" class="anchor"><span id="_Toc525037185" class="anchor"></span></span>Scenario 3: De eerste halte van een rit vervalt

Een rit zal rijden zoals gepland, met één wijziging: de geplande eerste
(begin)halte zal niet worden aangedaan. De rest van de uitvoering zal
volgens planning verlopen. Hiervoor dient een SHORTEN bericht verstuurd
te worden voor de betreffende rit en versterkingsnummer. Om eventueel
aan te geven wat de reden is voor het vervallen van de eerste halte is
en een mogelijk reizigersadvies te geven, kan een MUTATIONMESSAGE voor
de eerste halte verstuurd worden.

Het effect van het SHORTEN bericht is dat aan de integrator
gecommuniceerd wordt dat de rit niet langs de betreffende halte (hier
H~0~ genoemd) zal komen.

Het effect van het CHANGEPASSTIMES bericht is dat de correcte geplande
aankomst- en vertrektijden gecommuniceerd worden, de correcte tijd voor
een beginhalte geselecteerd wordt, hier de vertrektijd (want
beginhalte).

Het effect van het optionele MUTATIONMESSAGE bericht is dat aan de
integrator gecommuniceerd wordt dat er een oorzaak en advies aan de
reiziger getoond kan worden.

<span id="_Toc525037228" class="anchor"></span>Figuur 5 Scenario 3: De
eerste halte van een rit vervalt

### Scenario 4: Laatste passage van een rit vervalt en bestemming wijzigt

In dit scenario vervalt van een geplande rit de laatste passage.
Hiervoor wordt een SHORTEN bericht gestuurd voor de betreffende
eindhalte H~e~. De een-na-laatste halte H~n~ wordt de laatste halte en
toont de aankomsttijd; de haltes voor de laatste halte krijgen een
nieuwe bestemming.

Voor de laatste halte H~n~ moet een CHANGEPASSTIMES bericht verstuurd.
Het effect van het CHANGEPASSTIMES bericht is dat de correcte geplande
aankomst- en vertrektijden gecommuniceerd worden, de correcte tijd voor
een eindhalte geselecteerd wordt, hier de aankomsttijd (want eindhalte).

Eventueel kan er voor alle haltes op de rit een MUTATIONMESSAGE bericht
verstuurd worden om aan te geven wat de reden is dat de eindhalte
vervalt en een mogelijk advies.

Als laatste moeten alle haltes op de rit een CHANGEDESTINATION bericht
krijgen om aan te geven wat de nieuwe bestemming is.

<span id="_Toc525037229" class="anchor"></span>Figuur 6 Scenario 4:
Laatste halte van een rit vervalt en bestemming wijzigt

### Scenario 5: Vertrektijd op één halte worden 5 minuten uitgesteld

Een rit zal halte H~n~ passeren, conform de geplande haltetijden t~a~ en
t~v~. De CVL besluit echter het voertuig 5 minuten te laten wachten op
aansluiting.

Het laten wachten op aansluiting gebeurt met een LAG bericht, waarbij op
de halte de vertrektijd met een bepaalde tijd wordt uitgesteld. Deze
halte wordt nu behandeld als tijdhalte, waarmee de uitgestelde
vertrektijd een vaste prognosetijd wordt.

Ook in dit geval kan een MUTATIONMESSAGE bericht verstuurd worden naar
de halte waar de vertrektijd aangepast wordt.

Er van uitgaande dat de volgende haltes op de rit dezelfde geplande
aankomst- en vertrektijden houden, mogen er geen CHANGEPASSTIMES
berichten verstuurd worden.

Veranderen de geplande tijden wel, dan moeten er CHANGEPASSTIMES
berichten verstuurd worden naar de betrokken haltes. Het effect van het
CHANGEPASSTIMES bericht is dat de correcte geplande aankomst- en
vertrektijden gecommuniceerd worden en de correcte tijd voor de
betrokken halte geselecteerd wordt, hier meerdere tussenhaltes en een
eindhalte.

<span id="_Toc525037230" class="anchor"></span>Figuur 7 Scenario 5:
Haltetijden op één halte worden 5 minuten uitgesteld

### Scenario 6: Passage op rit krijgt andere geplande aankomst- en vertrektijden

De geplande aankomst- en vertrektijden van rit 0 op passage Hn/P
veranderen. Hiervoor worden met behulp van een CHANGEPASTIMES bericht de
geplande aankomst- en vertrektijden voor tussenhalte Hn/passage P
gewijzigd.

<span id="_Toc525037231" class="anchor"></span>Figuur 8 Scenario 6: Een
passage op een rit krijgt andere geplande aankomst- en vertrektijden

### Scenario 7: Een vervallen passage niet meer tonen

Het communiceren van het vervallen van een dienstregeling rit / passage
gebeurt met het CANCEL, resp. SHORTEN bericht. In de regel worden
vervallen ritten op de displays getoond als “rijdt niet” o.i.d. In
sommige situaties wil men echter liever de vervallen rit(ten) *niet*
tonen. Dit kan direct worden aangegeven in het CANCEL of SHORTEN
bericht, maar kan ook op een later moment alsnog worden geregeld via een
MUTATIONMESSAGE bericht.

<span id="_Toc525037232" class="anchor"></span>Figuur 9 Scenario 7: Een
vervallen rit niet meer tonen

Berichten 
==========

Beschrijving van de gebruikte XML. Onderscheiden worden het PUSH, het
RESPONSE, het REQUEST, en het HEARTBEAT document. De berichten zijn
i.v.m. leesbaarheid van spaties voorzien tussen de tags. ***In
werkelijkheid zijn deze spaties niet aanwezig!!***

In dit hoofdstuk worden de tabellen uit hoofdstuk 2.3 vertaald naar XML
berichten. Merk hierbij op dat de gemeenschappelijke sleutels, die de
rit identificeren, buiten de individuele berichten zijn gehaald. De
resulterende structuur is dus inhoudelijk gelijk aan de tabellen in 2.3,
maar qua vorm anders.

<span id="_Toc222833851" class="anchor"><span id="_Toc525037191" class="anchor"></span></span>Het PUSH document
---------------------------------------------------------------------------------------------------------------

Het PUSH document wordt gebruikt om de informatie vanaf de vervoerder
naar de integrator(en) te transporteren.

De XML definitie voor VV\_TM\_PUSH versie 8.0 en hoger ziet er als volgt
uit:

&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;tmi8:VV\_TM\_PUSH

xmlns:tmi8c="http://bison.connekt.nl/tmi8/kv17/core"
xmlns:tmi8=”http://bison.connekt.nl/tmi8/kv17/msg”&gt;

&lt;tmi8:SubsciberID&gt; SUBSCRIBERID &lt;/tmi8:SubscriberID&gt;

&lt;tmi8:Version&gt; VERSION &lt;/tmi8:Version&gt;

&lt;tmi8:DossierName&gt; DOSSIERNAME &lt;/tmi8:DossierName&gt;

&lt;tmi8:Timestamp&gt; TIMESTAMP &lt;/tmi8:Timestamp&gt;

&lt;tmi8:DOSSIER&gt; ^1^

&lt;tmi8:JOURNEY&gt;

> &lt;tmi8:daowcode&gt; DAOWCODE &lt;/tmi8:daowcode&gt;
>
> &lt;tmi8:lineplanningnumber&gt; LINEPLANNINGNUMBER
> &lt;/tmi8:linplanningnumber&gt;
>
> &lt;tmi8:operatingday&gt; OPERATINGDAY &lt;/tmi8:operatingday&gt;
>
> &lt;tmi8:journeynumber&gt; JOURNEYNUMBER &lt;/tmi8:journeynumber&gt;
>
> &lt;tmi8:reinforcmentnumber&gt; REINFORCMENTNUMBER
> &lt;/tmi8:reinforcmentnumber&gt;
>
> RECORDEXTENSIE

&lt;/tmi8:JOURNEY&gt;

&lt;tmi8:MUTATEJOURNEY&gt;

> &lt;tmi8:timestamp&gt; zie tabel &lt;/tmi8timestamp&gt;
>
> &lt;tmi8:OBJECTNAME&gt;^2^
>
> RECORDDATA
>
> RECORDEXTENSIE
>
> &lt;/tmi8:OBJECTNAME&gt;

&lt;/tmi8:MUTATEJOURNEY&gt;

&lt;tmi8:MUTATEJOURNEYSTOP&gt;

> &lt;tmi8:timestamp&gt; zie tabel &lt;/tmi8timestamp&gt;
>
> &lt;tmi8:OBJECTNAME&gt;^1,3^
>
> RECORDDATA
>
> RECORDEXTENSIE
>
> &lt;/tmi8:OBJECTNAME&gt;

&lt;/tmi8:MUTATEJOURNEYSTOP&gt;

&lt;/tmi8:DOSSIER&gt;

&lt;/tmi8:VV\_TM\_PUSH&gt;

^1^) 0 of meer van deze velden (zoveel als nodig).

^2^) voor CANCEL of RECOVER objecten (eenmaal)

^3^) voor SHORTEN, LAG, CHANGEPASSTIMES, CHANGEDESTINATION en
MUTATIONMESSAGE objecten (zo vaak als nodig)

  Naam                 Omschrijving                                                                                                 Waarde
  -------------------- ------------------------------------------------------------------------------------------------------------ ------------------------------------------------
  SUBSCRIBERID         In overleg tussen vervoerder en integrator toegekende waarde, identificatie voor de afnemer.                 In onderling overleg vervoerder en integrator.
  VERSION              Versie van het betreffend dossier. Alleen de drie hoogste niveaus: &lt;major&gt;.&lt;minor&gt;.&lt;fix&gt;   8.2.0
  DOSSIERNAME          Naam van het dossier (type).                                                                                 KV17cvlinfo
  TIMESTAMP            Tijd van aanmaken van het PUSH document, UTC (ISO 8601)                                                      YYYY‑MM‑DDThh:mm:ssTZD
  DOSSIER              Dossier tag, tag die het dossier aangeeft.                                                                   KV17cvlinfo
  DAOWCODE             Zie tabel E1                                                                                                 Zie tabel E1
  LINEPLANNINGNUMBER   Zie bericht definities                                                                                       Zie bericht definities
  OPERATINGDAY         Zie bericht definities                                                                                       Zie bericht definities
  JOURNEYNUMBER        Zie bericht definities                                                                                       Zie bericht definities
  REINFORCMENTNUMBER   Zie bericht definities                                                                                       Zie bericht definities
  RECORDDATA           Zie bericht definities                                                                                       Zie bericht definities
  OBJECTNAME           Object tag volgens objecten tabel.                                                                           Zie object tabel.
  RECORDEXTENSIE       Toekomstige extensie                                                                                         Zie XSD.

<span id="_Ref223417644" class="anchor"><span id="_Toc525037217"
class="anchor"></span></span>Tabel 13 PUSH document informatie

Voor RECORDDATA velden wordt verwezen naar de xml tag kolom in de object
tabellen voor het betreffende OBJECTNAME, waarbij opgemerkt dient te
worden dat de betreffende xml tag voorafgegaan wordt door de correcte
namespace. Sleutelvelden dienen niet als RECORDDATA beschouwd te worden.
Zie XSD voor meer informatie.

Voor RECORDEXTENSIE wordt verwezen naar de XSD.

<span id="_Toc222833852" class="anchor"><span id="_Toc525037192" class="anchor"></span></span>Het RESPONSE document
-------------------------------------------------------------------------------------------------------------------

Het RESPONSE document kent slechts een versie. Het RESPONSE document
wordt gebruikt als response op een eerder ontvangen PUSH of REQUEST
document, om aan te geven hoe de verwerking van het betreffende document
was. De responsecode geeft aan of de verwerking succesvol of niet
succesvol was.

De XML definitie voor VV\_TM\_RES hoger ziet er als volgt uit (Version,
DossierName en Timestamp zijn optioneel):

&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;tmi8:VV\_TM\_RES xmlns

xmlns:tmi8c="http://bison.connekt.nl/tmi8/kv17/core"
xmlns:tmi8=”http://bison.connekt.nl/tmi8/kv17/msg”&gt;

&lt;tmi8:SubsciberID&gt; SUBSCRIBERID &lt;/tmi8:SubscriberID&gt;

&lt;tmi8:Version&gt; VERSION &lt;/tmi8:Version&gt;

&lt;tmi8:DossierName&gt; DOSSIERNAME &lt;/tmi8:DossierName&gt;

&lt;tmi8:Timestamp&gt; TIMESTAMP &lt;/tmi8:Timestamp&gt;

&lt;tmi8:ResponseCode&gt; RESPONSECODE &lt;/tmi8:ResponseCode&gt;

&lt;tmi8:ResponseError&gt; FOUTMELDING &lt;/tmi8:ResponseError&gt;^1^

&lt;/tmi8:VV\_TM\_RES&gt;

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Naam           Omschrijving                                                                                                          Waarde
  -------------- --------------------------------------------------------------------------------------------------------------------- ----------------------------------------------
  RESPONSECODE   Indicatie van de verwerking van het voorgaande PUSH of REQUEST document                                               OK – het document is succesvol verwerkt
                                                                                                                                       
                                                                                                                                       SE – document syntax is niet correct
                                                                                                                                       
                                                                                                                                       NOK –het document is niet succesvol verwerkt
                                                                                                                                       
                                                                                                                                       NA – het document is niet toegestaan
                                                                                                                                       
                                                                                                                                       PE – het document heeft een protocol fout

  FOUTMELDING    Gedetailleerde foutmelding indien de verwerking niet succesvol was.                                                   Applicatie afhankelijk.

  VERSION        XML versie van het verwerkte PUSH document. Alleen de drie hoogste niveaus: &lt;major&gt;.&lt;minor&gt;.&lt;fix&gt;   8.2.0

  TIMESTAMP      Tijd van aanmaken RESPONSE document, UTC (ISO 8601)                                                                   YYYY‑MM‑DDThh:mm:ssTZD
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

<span id="_Toc525037218" class="anchor"></span>Tabel 14 RESPONSE
document informatie

<span id="_Toc222833853" class="anchor"><span id="_Toc228171979"
class="anchor"></span></span>

Het REQUEST document
--------------------

Het REQUEST document kent slechts één versie. Een REQUEST document wordt
gebruikt om de vervoerder CVL ingrepen opnieuw te laten versturen. Het
gaat hierbij om koppelvlak 17 berichten die op het moment dat het
REQUEST gedaan wordt geldig zijn of nog moeten worden. Dit zijn
de actieve en reeds vastgelegde toekomstige CVL ingrepen**.**

De XML definitie voor VV\_TM\_REQ hoger ziet er als volgt uit:

&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;tmi8:VV\_TM\_REQ xmlns

xmlns:tmi8c="http://bison.connekt.nl/tmi8/kv17/core"
xmlns:tmi8=”http://bison.connekt.nl/tmi8/kv17/msg”&gt;

&lt;tmi8:SubscriberID&gt; SUBSCRIBERID &lt;/tmi8:SubscriberID&gt;

&lt;tmi8:Version&gt; VERSION &lt;/tmi8:Version&gt;

&lt;tmi8:DossierName&gt; DOSSIERNAME &lt;/tmi8:DossierName&gt;

&lt;tmi8:Timestamp&gt; TIMESTAMP &lt;/tmi8:Timestamp&gt;

&lt;/tmi8:VV\_TM\_REQ&gt;

  Naam           Omschrijving                                                                                       Waarde
  -------------- -------------------------------------------------------------------------------------------------- ---------------------------------------------
  SUBSCRIBERID   In overleg tussen vervoerder en integrator toegekende waarde, identificatie voor de afnemer.       In onderling overleg integrator en afnemer.
  VERSION        Ondersteunde XML versie. Alleen de drie hoogste niveaus: &lt;major&gt;.&lt;minor&gt;.&lt;fix&gt;   8.2.0
  DOSSIERNAME    Naam van het dossier (type).                                                                       KV17cvlinfo
  TIMESTAMP      Tijd van aanmaken REQUEST document, UTC (ISO 8601)                                                 YYYY‑MM‑DDThh:mm:ssTZD

<span id="_Ref223419486" class="anchor"><span id="_Toc228172039"
class="anchor"><span id="_Toc525037219"
class="anchor"></span></span></span>Tabel 15 REQUEST document informatie

Het systeem HEARTBEAT document
------------------------------

Het systeem HEARTBEAT document is voor koppelvlak 17 niet van
toepassing. Indien toch verstuurd kan het ontvangend systeem reageren
met een RESPONSE document met RESPONSECODE NA.

<span id="_Toc222833854" class="anchor"></span>

XML Document responsetijden
---------------------------

De verschillende dossiers hebben een maximale responsetijd. Binnen deze
tijd moet het afnemend systeem aan het aanleverend systeem een response
verstuurd hebben.

  Dossiernaam   Maximaal aantal haltes   Maximale responstijd
  ------------- ------------------------ ----------------------
  KV17cvlinfo   n.v.t.                   30 seconden
                                         

<span id="_Toc525037220" class="anchor"></span>Tabel 16 XML Document
responsetijden

Maximale tijd tussen berichten
------------------------------

Koppelvlak 17 kent geen heartbeat mechanisme of verplicht interval van
versturen van berichten. Het afnemend systeem kan dus niet detecteren of
het aanleverend systeem beschikbaar is. Om deze reden is er geen
maximale tijd tussen koppelvlak 17 berichten gedefinieerd.

  Omschrijving                                    Tijd
  ----------------------------------------------- --------
  Maximale tijd tussen twee XML PUSH documenten   n.v.t.

<span id="_Toc525037221" class="anchor"></span>Tabel 17 Maximale tijd
tussen twee XML PUSH documenten

<span id="_Toc222833856" class="anchor"></span>

XML Schema Definitie
--------------------

De XML Schema Definitie (XSD) van de hier beschreven berichten is
opgenomen in Bijlage 1: XML Schema Definitie. <span id="_Toc222833857"
class="anchor"></span>Tabel 18 toont per versie van dit koppelvlak de te
gebruiken XSD. De XML header parameter *xsi:schemaLocation* dient naar
de juiste XSD te verwijzen.

                                         Compatibiliteit
  ------------------- ------------------ --------------------- --------------------
  Koppelvlak versie   XSD definitie      Toekomstige versies
  v8.1.0              kv17-msg.xsd       v8.1.0 en hoger
  v8.2.0              kv17.820-msg.xsd   v8.2.0 en hoger

<span id="_Ref390944473" class="anchor"><span id="_Toc487205024"
class="anchor"><span id="_Toc525037222"
class="anchor"></span></span></span>Tabel 18 XML schema definitie per
koppelvlak versie

Verzendmechanisme / Protocol
----------------------------

Een definitie van het te gebruiken protocol is beschreven in Bijlage 2:
Verzendmechanisme / Protocol.

<span id="_Ref242702707" class="anchor"><span id="_Toc242707146"
class="anchor"><span id="_Toc222833858"
class="anchor"></span></span></span>

Transport parameters
--------------------

Parameters voor bericht herttransmissies en bericht wachtrij tijden.
Deze waardes zijn nog niet vastgesteld, en dienen nog nader uitgewerkt
te worden.

  Dossiernaam   Parameter          Waarde             Omschrijving
  ------------- ------------------ ------------------ ------------------------------------------------------------------------------------------------------------------------------------------------
  KV17cvlinfo   MAX\_RETRY         Nader te bepalen   Maximaal aantal malen dat een hertransmissie voor een bericht uitgevoerd wordt.
                MAX\_QUEUE\_TIME   Nader te bepalen   De maximale tijd dat een bericht in een verzendwachtrij mag staan voordat het als niet meer relevant beschouwd wordt en weggegooid mag worden.

<span id="_Toc242707181" class="anchor"><span id="_Toc525037223"
class="anchor"></span></span>Tabel 19 Transport parameters

<span id="_Ref241080894" class="anchor"><span id="_Toc525037200" class="anchor"></span></span>Bijlage 1: XML Schema Definitie
=============================================================================================================================

Aanvullend op de object definitie in dit document wordt een XSD ter
beschikking gesteld. Op basis van deze XSD kunnen XML berichten volgens
de definitie worden gegenereerd en kunnen XML berichten op inhoud worden
gecontroleerd. Daar waar (nog) afwijkingen bestaan tussen de XSD en de
object definitie in dit document, is vooralsnog de object definitie
zoals in dit document beschreven leidend. BISON wil graag op de hoogte
gesteld worden van enige discrepantie tussen de XSD en de object
definitie.

Voor XSD wordt verwezen naar de externe bijlage, onderstaande figuren
toont de XSD structuur.

Opgemerkt wordt dat in de XSD gebruik gemaakt wordt van de constructie

&lt;xs:element ref="tmi8c:delimiter"/&gt;

&lt;xs:any namespace="\#\#targetNamespace \#\#local"
processContents="lax" minOccurs="0" maxOccurs="unbounded"/&gt;

Deze constructie wordt gebruikt voor toekomstige uitbreidbaarheid. Zij
doet dit door velden, die na de gedefinieerde velden komen maar niet in
de XSD zijn gedefinieerd, te beschouwen als onderdeel van een
‘container’, die verder genegeerd wordt. Op deze manier wordt het
mogelijk om toekomstige versies, die meer velden definiëren, te
interpreteren als ware zij een oudere versie.

![](media/image12.png){width="6.298611111111111in"
height="2.109722222222222in"}

<span id="_Toc525037233" class="anchor"></span>Figuur 10 XSD
VV\_TM\_PUSH

![](media/image13.png){width="6.298611111111111in"
height="1.7354166666666666in"}

<span id="_Toc525037234" class="anchor"></span>Figuur 11 XSD VV\_TM\_REQ

![](media/image14.png){width="6.291666666666667in"
height="2.2708333333333335in"}

<span id="_Toc228202296" class="anchor"><span id="_Toc525037235"
class="anchor"></span></span>Figuur 12 XSD VV\_TM\_RES

![](media/image15.png){width="6.291666666666667in"
height="1.9833333333333334in"}

<span id="_Ref225756830" class="anchor"><span id="_Toc525037236"
class="anchor"></span></span>Figuur 13 XSD KV17cvlinfo

![](media/image16.png){width="6.35in" height="3.0078947944006997in"}

<span id="_Toc525037237" class="anchor"></span>Figuur 14 XSD KV17JOURNEY

![](media/image17.png){width="6.291666666666667in"
height="1.9166666666666667in"}

<span id="_Toc525037238" class="anchor"></span>Figuur 15 XSD
KV17MUTATEJOURNEY

![](media/image18.png){width="6.291666666666667in" height="4.09375in"}

<span id="_Toc525037239" class="anchor"></span>Figuur 16 XSD
KV17MUTATEJOURNEYSTOP

![](media/image19.png){width="4.175in" height="3.389229002624672in"}

<span id="_Toc525037240" class="anchor"></span>Figuur 17 XSD CANCEL

![](media/image20.png){width="4.788888888888889in" height="1.175in"}

<span id="_Toc525037241" class="anchor"></span>Figuur 18 XSD RECOVER

![](media/image21.png){width="4.558333333333334in"
height="2.0755807086614175in"}

<span id="_Toc525037242" class="anchor"></span>Figuur 19 XSD SHORTEN

![](media/image22.png){width="6.291666666666667in"
height="1.9666666666666666in"}

<span id="_Toc525037243" class="anchor"></span>Figuur 20 XSD LAG

![](media/image23.png){width="6.291666666666667in"
height="2.691666666666667in"}

<span id="_Toc525037244" class="anchor"></span>Figuur 21 XSD
CHANGEPASSTIMES

![](media/image24.png){width="6.291666666666667in"
height="3.2708333333333335in"}

<span id="_Toc525037245" class="anchor"></span>Figuur 22 XSD
CHANGEDESTINATION

![](media/image25.png){width="4.676767279090114in"
height="3.8583333333333334in"}

<span id="_Toc525037246" class="anchor"></span>Figuur 23 XSD
MUTATIONMESSAGE

<span id="_Ref241081016" class="anchor"><span id="_Toc525037201" class="anchor"></span></span>Bijlage 2: Verzendmechanisme / Protocol
=====================================================================================================================================

<span id="_Ref241080919" class="anchor"></span>

Binnen het koppelvlak wordt de volgende protocol stapel gebruikt (figuur
24).

  KVX APPLICATIE   &lt;------ Applicatie Informatie ------&gt;   KVX APPLICATIE
  ---------------- --------------------------------------------- ----------------
  HTTP             &lt;------ HTTP Informatie ------&gt;         HTTP
  TCP                                                            TCP
  IP                                                             IP
  DATALINK                                                       DATALINK
  FYSIEK                                                         FYSIEK

<span id="_Ref222815121" class="anchor"><span id="_Toc525037247"
class="anchor"></span></span>Figuur 24 Koppelvlak protocol stapel

Bij het gebruik van HTTP als methode om informatie tussen systemen over
te brengen is het volgende belangrijk:

-   Informatie wordt aangeleverd met het HTTP POST commando.

-   De te gebruiken URI voor het PUSH bericht heeft de volgende vorm:

> [http://afnemend\_systeem:PORT/DOSSIERNAAM](http://afnemend_systeem:PORT/DOSSIERNAAM)
>
> Waarbij PORT staat voor de HTTP port waarop het afnemend systeem de
> informatie verwacht, en DOSSIERNAAM staat voor één van de koppelvlak
> dossiernamen zoals in tabel 13 genoemd.

-   De te gebruiken URI voor het REQUEST[^2] bericht heeft de volgende
    vorm:

> [http://aanleverend\_systeem:PORT/TMI\_Request](http://aanleverend_systeem:PORT/TMI_Request)
>
> Waarbij PORT staat voor de HTTP port waarop het aanleverend systeem de
> aanvraag verwacht.

-   Als meegeleverde URI in het HTTP POST niet verwerkt kan worden wordt
    dit in een HTTP RESPONSE gemeld.

-   Het ontvangende systeem verwerkt de aangeleverde informatie binnen
    de daarvoor gestelde tijd en reageert met HTTP RESPONSE 200 om aan
    te geven dat de HTTP aanvraag verwerkt is. Treedt er tijdens de
    verwerking van de informatie problemen op dan wordt in de HTTP
    RESPONSE meegeleverd (volgens de daarvoor geldende XML
    response document).

Daarnaast is het maximaal aantal gelijktijdig openstaande HTTP POST
aanvragen van belang.

Een HTTP POST commando ziet er als volgt uit:

Het bijbehorende HTTP RESPONSE ziet er als volgt uit:

Figuur 25 geeft de berichten uitwisseling tussen een vervoerder (V) en
een integrator (I) weer.

Voor meer informatie over het gebruik van het HTTP protocol wordt
verwezen naar de IETF RFC [1945](http://www.ietf.org/rfc/rfc1945.txt) en
RFC [2616](http://www.ietf.org/rfc/rfc2616.txt).

<span id="_Ref222814408" class="anchor"><span id="_Toc525037248"
class="anchor"></span></span>Figuur 25 HTTP POST protocol berichten
uitwisseling

<span id="_Toc228202433" class="anchor"><span id="_Toc230402575" class="anchor"><span id="_Toc525037202" class="anchor"></span></span></span>Bijlage 3: Voorbeeld scenario gebruik koppelvlak 17 in Utrecht
===========================================================================================================================================================================================================

Deze bijlage beschrijft een situatie zoals deze zich op een operationele
dag voor kan doen.

Connexxion exploiteert een lijn, 120, van Utrecht Station Overvecht naar
Utrecht Uithof/UMC. Vandaag betreft het:

-   Lijn 120 van Utrecht Noord naar UMC

-   Ritnummer 525

-   Datum 12 januari 2009

-   Lijn passeert tien haltes

    -   Halte Utrecht Noord (beginhalte)

    -   Halte Station Overvecht

    -   Halte3

    -   Halte4

    -   Halte Station Utrecht Centraal

    -   Halte Neude

    -   Halte7

    -   Halte8

    -   Halte9

    -   Halte UMC (eindhalte, bestemmingscode = UtrUMC02)

-   Geplande vertrektijd beginhalte 8.35u

-   Geplande aankomsttijd eindhalte 9.25u

-   Op Halte Station Utrecht Centraal wordt 5 minuten gewacht.

-   Er zijn geen haltes die meer dan één keer worden aangedaan

De uitgangssituatie is dus als volgt:

  **Halte nummer**   **Halte**                  **Geplande aankomsttijd**   **Geplande vertrektijd**
  ------------------ -------------------------- --------------------------- --------------------------
  101                Halte Utrecht Noord        -                           8.35
  102                Station Overvecht          8.40                        8.40
  103                Halte3                     8.45                        8.45
  104                Halte4                     8.50                        8.50
  105                Station Utrecht Centraal   8.55                        9.00
  106                Neude                      9.05                        9.05
  107                Halte7                     9.10                        9.10
  108                Halte8                     9.15                        9.15
  109                Halte9                     9.20                        9.20
  110                UMC                        9.25                        -

De rit zal als zodanig gereden worden door één voertuig. De CVL besluit
echter dat, vanwege werkzaamheden, de rit ingekort zal worden. Dit feit
wordt ook op halte Centraal Station expliciet gemeld. Stapsgewijs gaat
het om:

1.  Inkorten van het begin van de lijn met één halte (halte 101)

2.  Inkorten van het einde van de lijn met vier haltes (haltes 107
    t/m 110)

3.  Veranderen van de geplande haltetijden (+ 5min) voor haltes 102 t/m
    106

4.  Veranderen van de bestemming in “Utrecht Neude”, code UtrNeude01, op
    haltes 102 t/m 105

5.  Het mededelen van de reden van de inkorting (‘werkzaamheden’) op
    halte 105

De gemuteerde rit ziet er als volgt uit:

  **Halte nummer**   **Halte**                  **Geplande aankomsttijd**   **Geplande vertrektijd**
  ------------------ -------------------------- --------------------------- --------------------------
  102                Station Overvecht          -                           8.45
  103                Halte3                     8.50                        8.50
  104                Halte4                     8.55                        8.55
  105                Station Utrecht Centraal   9.00                        9.05
  106                Neude                      9.10                        -

Dit plan kan in één koppelvlak 17 bericht gecommuniceerd worden.
Daarvoor benodigd zijn de volgende commando’s in één bericht voor rit
120/525 op 12-01-2009 (er is geen volgordelijkheid in de verwerking van
de berichten):

-   SHORTEN(halte 101)

-   SHORTEN(halte 110)

-   SHORTEN(halte 109)

-   SHORTEN(halte 108)

-   SHORTEN(halte 107)

-   CHANGEPASSTIMES(halte 102, type = BEGIN, aankomsttijd = 0.00,
    vertrektijd = 8.45)

-   CHANGEDESTINATION(halte 102, bestemming = Neude)

-   CHANGEPASSTIMES(halte 103, aankomsttijd = 8.50, vertrektijd = 8.50)

-   CHANGEDESTINATION(halte 103, bestemming = Neude)

-   CHANGEPASSTIMES(halte 104, aankomsttijd = 8.55, vertrektijd = 8.55)

-   CHANGEDESTINATION(halte 104, bestemming = Neude)

-   CHANGEPASSTIMES(halte 105, aankomsttijd = 9.00, vertrektijd = 9.05)

-   CHANGEDESTINATION(halte 105, bestemming = Neude)

-   CHANGEPASSTIMES(halte 106, type = EIND, aankomsttijd = 9.10,
    vertrektijd = 0.00)

-   MUTATIONMESSAGE(halte 105, reden = ‘werkzaamheden’)

Dit voorbeeld is nader uitgewerkt in een XML-bestand. Hierbij is GOVI
gekozen als voorbeeld-afnemer van de informatie.

<span id="_Ref241080484" class="anchor"><span id="_Toc525037203" class="anchor"></span></span>Bijlage 4: Voorbeeld technische koppeling tussen koppelvlak 17 en koppelvlak 1
============================================================================================================================================================================

In hoofdstuk 2.4 is aangegeven dat er geen directe koppeling is tussen
de koppelvlakken 1 en 17, en dat het de verantwoording van de integrator
om afspraken met de vervoerder te maken om een koppeling te realiseren.
Om hieraan tegemoet te komen is in deze bijlage een mogelijke indirecte
koppeling tussen koppelvlak 1 en koppelvlak 17 in tekst en in de vorm
van een ERD beschreven.

Deze bijlage toont een mogelijke technische oplossing, er kunnen geen
verplichtingen aan ontleedt Een ERD beschrijft de afhankelijkheden en
relaties tussen de objecten. Figuur 26 beschrijft de afhankelijkheden
van de koppelvlak 17 objecten met koppelvlak 1.

Gebruikte notatie is volgens UML, met de toevoeging dat een gestippelde
verbinding tussen twee objecten duidt op het gebruikt van een niet
sleutel waarde bij een van de objecten.

Op basis van de attributen DataOwnerCode, LinePlanningNumber,
JourneyNumber, en OperatingDay wordt het koppelvlak 17 bericht
gerelateerd aan de bijbehorende rit in de dienstregeling binnen
koppelvlak 1. Op basis van de attributen DataOwnerCode,
LinePlanningNumber, JourneyNumber, en UserStopCode wordt het koppelvlak
17 bericht gerelateerd aan de bijbehorende halte op de rit in de
dienstregeling binnen koppelvlak 1. Vervolgens wordt het attribuut
PassageSequenceNumber gebruikt om de juiste passage voor de halte te
bepalen, waarbij opgemerkt moet worden dat PassageSequenceNumber zich
niet een op een laat vertalen naar een van de bijbehorende attributen
StopOrderNumber of TiminglinkOrderNumber, en daar dus een vertaling
(door de integrator) plaats moet vinden. Het attribuut
ReinforcementNumber wordt niet gebruikt binnen koppelvlak 1. Wel wordt
het attribuut ReinforcementNumber gebruikt om binnen het koppelvlak 17
het gerelateerde voertuig uniek te kunnen bepalen.

De gegevens uit het koppelvlak 17 bericht dienen te corresponderen met
de planning, die via koppelvlak 1 is aangeleverd. Als er geen relatie is
tussen het koppelvlak 17 bericht en de dienstregeling uit koppelvlak 1
is, kan het koppelvlak 17 bericht niet verwerkt worden en dient dit in
de response aangegeven te worden met een NOK.

Koppelvlak 17 koppelt aan een zogenaamd ‘Dated Vehicle Journey Pass’
tabel, welke opgesteld wordt door de Integrator op basis van koppelvlak
1.

De basis van ieder koppelvlak 17 bericht is een vooraf geplande rit.
Deze noemen we de publieksrit. Een publieksrit wordt geïdentificeerd op
basis van de attributen uitvoerende partij (DataOwnerCode), gepland
lijnnummer (LinePlanningNumber) en ritnummer (JourneyNumber). De dag van
uitvoering wordt gespecificeerd door middel van de OperatingDay.

Op één publieksrit (Public Journey) kunnen meerdere wagenritten (Vehicle
Journey) rijden. Deze worden onderscheiden naar hun Versterkingsnummer
(ReinforcementNumber). Dit wordt op dit moment binnen het koppelvlak
**niet** ondersteund.

Een wagenrit doet twee of meer haltes aan. Eén halte kan meer dan één
maal aangedaan worden. Daarom spreken we niet over haltes, maar over
passages. Deze bestaan uit het haltenummer (UserStopCode, het
haltenummer in het domein van de betreffende vervoerder) en een passage
nummer (PassageSequenceNumber).

Dit totaal aan gegevens wordt door de Integrator voor iedere
exploitatiedag klaargezet in een tabel met daarin de passeertijden voor
actuele ritten. Deze wordt samengesteld op basis van een eerder
gecommuniceerde dienstregeling (door middel van koppelvlak 1).

<span id="_Ref236125292" class="anchor"><span id="_Ref236125286"
class="anchor"><span id="_Toc525037249"
class="anchor"></span></span></span>Figuur 26 Relatie tussen koppelvlak
1, DATEDVEJOPASS en koppelvlak 17

In Figuur 26 is de relatie weergegeven tussen deze DATEDVEJOPASS tabel,
en de diverse berichten binnen koppelvlak 17.

Het laten vervallen van ritten, of het herroepen van eerdere wijzigingen
op een rit (respectievelijk CANCEL en RECOVER) hebben betrekking op
wagenritten, dus een publieksrit plus een versterkingsnummer.

Bijlage 5: Creative Commons by/nd/3.0/nl licentie
=================================================

Zoals te vinden op
<http://creativecommons.org/licenses/by-nd/3.0/nl/legalcode>:

**LICENTIE**

HET WERK (ALS HIERONDER OMSCHREVEN) WORDT TER BESCHIKKING GESTELD
OVEREENKOMSTIG DE VOORWAARDEN VAN DEZE CREATIVE COMMONS PUBLIEKE
LICENTIE ('CCPL' OF 'LICENTIE'). HET WERK WORDT BESCHERMD OP GROND VAN
HET AUTEURSRECHT, NABURIGE RECHTEN, HET DATABANKENRECHT EN/OF ENIGE
ANDERE TOEPASSELIJKE RECHTEN. MET UITZONDERING VAN HET IN DEZE LICENTIE
OMSCHREVEN TOEGESTANE GEBRUIK VAN HET WERK IS ENIG ANDER GEBRUIK VAN HET
WERK NIET TOEGESTAAN.

DOOR HET UITOEFENEN VAN DE IN DEZE LICENTIE VERLEENDE RECHTEN MET
BETREKKING TOT HET WERK AANVAARDT EN GAAT DE GEBRUIKER AKKOORD MET DE
VOORWAARDEN VAN DEZE LICENTIE, MET DIEN VERSTANDE DAT (DE INHOUD VAN)
DEZE LICENTIE OP VOORHAND VOLDOENDE DUIDELIJK KENBAAR DIENT TE ZIJN VOOR
DE ONTVANGER VAN HET WERK.

DE LICENTIEGEVER VERLEENT DE GEBRUIKER DE IN DEZE LICENTIE OMSCHREVEN
RECHTEN MET INACHTNEMING VAN DE DESBETREFFENDE VOORWAARDEN.

**1. Definities**

a.  **'Verzamelwerk'** een werk waarin het Werk, in zijn geheel en in
    ongewijzigde vorm, samen met een of meer andere werken, die elk een
    afzonderlijk en zelfstandig werk vormen, tot een geheel
    is samengevoegd. Voorbeelden van een verzamelwerk zijn een
    tijdschrift, een bloemlezing of een encyclopedie. Een Verzamelwerk
    zal voor de toepassing van deze Licentie niet als een Afgeleid werk
    (als hieronder omschreven) worden beschouwd.

b.  **'Afgeleid werk'** een werk dat is gebaseerd op het Werk of op het
    Werk en andere reeds bestaande werken. Voorbeelden van een Afgeleid
    werk zijn een vertaling, een muziekschikking (arrangement), een
    toneelbewerking, een literaire bewerking, een verfilming, een
    geluidsopname, een kunstreproductie, een verkorte versie, een
    samenvatting of enig andere bewerking van het Werk, met dien
    verstande dat een Verzamelwerk voor de toepassing van deze Licentie
    niet als een Afgeleid werk zal worden beschouwd.\
    Indien het Werk een muziekwerk betreft, zal de synchronisatie van de
    tijdslijnen van het Werk en een bewegend beeld ('synching') voor de
    toepassing van deze Licentie als een Afgeleid Werk worden beschouwd.

c.  **'Licentiegever'** de natuurlijke persoon/personen of
    rechtspersoon/rechtspersonen die het Werk volgens de voorwaarden van
    deze Licentie aanbiedt/aanbieden.

d.  **'Maker'** de natuurlijke persoon/personen of
    rechtspersoon/personen die het oorspronkelijke werk
    gemaakt heeft/hebben. Voor de toepassing van deze Licentie wordt
    onder de Maker mede verstaan de uitvoerende kunstenaar, film- en
    fonogramproducent en omroeporganisaties in de zin van de Wet op de
    naburige rechten en de producent van een databank in de zin van
    de Databankenwet.

e.  **'Werk'** het auteursrechtelijk beschermde werk dat volgens de
    voorwaarden van deze Licentie wordt aangeboden. Voor de toepassing
    van deze Licentie wordt onder het Werk mede verstaan het fonogram,
    de eerste vastlegging van een film en het (omroep)programma in de
    zin van de Wet op de naburige rechten en de databank in de zin van
    de Databankenwet, voor zover dit fonogram, deze eerste vastlegging
    van een film, dit (omroep)programma en deze databank beschermd wordt
    krachtens de toepasselijke wet in de jurisdictie van de Gebruiker.

f.  **'Gebruiker'** de natuurlijke persoon of rechtspersoon die rechten
    ingevolge deze Licentie uitoefent en die de voorwaarden van deze
    Licentie met betrekking tot het Werk niet eerder geschonden heeft,
    of die van de Licentiegever uitdrukkelijke toestemming gekregen
    heeft om rechten ingevolge deze Licentie uit te oefenen ondanks een
    eerdere schending.

**2. Beperkingen van de uitsluitende rechten**

Niets in deze Licentie strekt ertoe om de rechten te beperken die
voortvloeien uit de beperkingen en uitputting van de uitsluitende
rechten van de rechthebbende krachtens het auteursrecht, de naburige
rechten, het databankenrecht of enige andere toepasselijke rechten.

**3. Licentieverlening**

Met inachtneming van de voorwaarden van deze Licentie verleent de
Licentiegever hierbij aan de Gebruiker een wereldwijde, niet-exclusieve
licentie om de navolgende rechten met betrekking tot het Werk vrij van
royalty's uit te oefenen voor de duur van de toepasselijke intellectuele
eigendomsrechten:

a.  het reproduceren van het Werk, het opnemen van het Werk in een of
    meerdere Verzamelwerken, en het reproduceren van het in de
    Verzamelwerken opgenomen Werk;

b.  het verspreiden van exemplaren van het Werk, het in het openbaar
    tonen, op- en uitvoeren en het on-line beschikbaar stellen van het
    Werk, afzonderlijk en als deel van een Verzamelwerk;

c.  het opvragen en hergebruiken van het Werk;

d.  Volledigheidshalve dient te worden vermeld dat:

    i.  **Niet voor afstand vatbare heffingsregelingen**. in het geval
        > van niet voor afstand vatbare heffingsregelingen (bijvoorbeeld
        > met betrekking tot thuiskopieën) de Licentiegever zich het
        > recht voorbehoudt om dergelijke heffingen te innen (al dan
        > niet door middel van een auteursrechtenorganisatie) bij zowel
        > commercieel als niet-commercieel gebruik van het Werk;

    ii. **Voor afstand vatbare heffingsregeling**. in het geval van voor
        > afstand vatbare heffingsregelingen (bijvoorbeeld met
        > betrekking tot leenrechten) de Licentiegever afstand doet van
        > het recht om dergelijke heffingen te innen bij zowel
        > commercieel als niet-commercieel gebruik van het Werk;

    iii. **Collectief rechtenbeheer**. de Licentiegever afstand doet van
        > het recht om vergoedingen te innen (zelfstandig of, indien de
        > Licentiegever lid is van een auteursrechtenorganisatie, door
        > middel van die organisatie) bij zowel commercieel als
        > niet-commercieel gebruik van het Werk.

De Gebruiker mag deze rechten uitoefenen met behulp van alle thans
bekende media, dragers en formats. De Gebruiker is tevens gerechtigd om
technische wijzigingen aan te brengen die noodzakelijk zijn om de
rechten met behulp van andere media, dragers en formats uit te oefenen,
maar is verder niet gerechtigd om Afgeleide Werken te maken. Alle niet
uitdrukkelijk verleende rechten zijn hierbij voorbehouden aan de
Licentiegever, met inbegrip van maar niet beperkt tot de rechten die in
artikel 4(d) worden genoemd. Voor zover de Licentiegever op basis van
het nationale recht ter implementatie van de Europese
Databankenrichtlijn over uitsluitende rechten beschickt doet de
Licentiegever afstand van deze rechten.

**4. Beperkingen**

De in artikel 3 verleende Licentie is uitdrukkelijk gebonden aan de
volgende beperkingen:

a.  De Gebruiker mag het Werk uitsluitend verspreiden, in het openbaar
    tonen, op- of on-line beschikbaar stellen met inachtneming van de
    voorwaarden van deze Licentie, en de Gebruiker dient een exemplaar
    van, of de Uniform Resource Identifier voor, deze Licentie toe te
    voegen aan elk exemplaar van het Werk dat de Gebruiker verspreidt,
    in het openbaar toont, op- of uitvoert, of on-line
    beschikbaar stelt. Het is de Gebruiker niet toegestaan om het Werk
    onder enige afwijkende voorwaarden aan te bieden waardoor de
    voorwaarden van deze Licentie dan wel de mogelijkheid van de
    ontvangers van het Werk om de rechten krachtens deze Licentie uit te
    oefenen worden beperkt. Het is de Gebruiker niet toegestaan om het
    Werk in sublicentie te geven. De Gebruiker dient alle vermeldingen
    die verwijzen naar deze Licentie dan wel naar de uitsluiting van
    garantie te laten staan. Het is de Gebruiker niet toegestaan om het
    Werk te verspreiden, in het openbaar te tonen, op- of uit te voeren
    of on-line beschikbaar te stellen met toepassing van technologische
    voorzieningen waardoor de voorwaarden van deze Licentie dan wel de
    mogelijkheid van de ontvangers van het Werk om de rechten krachtens
    deze Licentie uit te oefenen worden beperkt. Het voorgaande is
    tevens van toepassing op het Werk dat deel uitmaakt van een
    Verzamelwerk, maar dat houdt niet in dat het Verzamelwerk, afgezien
    van het Werk zelf, gebonden is aan de voorwaarden van deze Licentie.
    Indien de Gebruiker een Verzamelwerk maakt, dient deze, op verzoek
    van welke Licentiegever ook, de op grond van artikel 4(b) vereiste
    naamsvermelding uit het Verzamelwerk te verwijderen, voor zover
    praktisch mogelijk, conform het verzoek.

b.  Indien de Gebruiker het Werk of Verzamelwerken verspreidt, in het
    openbaar toont, op- of uitvoert of on-line beschikbaar stelt, dient
    de Gebruiker, tenzij er sprake is van een verzoek als vermeld in lid
    4(a), alle auteursrechtvermeldingen met betrekking tot het Werk te
    laten staan. Tevens dient de Gebruiker, op een wijze die redelijk is
    in verhouding tot het gebruikte medium, de naam te vermelden van (i)
    de Maker(of zijn/haar pseudoniem indien van toepassing) indien deze
    wordt vermeld; en/of (ii) van (een) andere partij(en) (b.v. sponsor,
    uitgeverij, tijdschrift) indien de naamsvermelding van
    deze partij(en) ("Naamsvermeldingsgerechtigden") in de
    auteursrechtvermelding of algemene voorwaarden van de Licentiegever
    of op een andere redelijke wijze verplicht is gesteld door de Maker
    en/of de Licentiegever; de titel van het Werk indien deze wordt
    vermeld; voorzover redelijkerwijs toepasbaar de Uniform Resource
    Identifier, indien aanwezig, waarvan de Licentiegever heeft
    aangegeven dat deze bij het Werk hoort, tenzij de URI niet verwijst
    naar de auteursrechtvermeldingen of de licentie-informatie
    betreffende het Werk. De Gebruiker dient op redelijke wijze aan de
    in dit artikel genoemde vereisten te voldoen; echter, met dien
    verstande dat, in geval van een Verzamelwerk, de naamsvermeldingen
    in ieder geval geplaatst dienen te worden, indien er een
    naamsvermelding van alle makers van het Verzamelwerk geplaatst wordt
    dan als deel van die naamsvermeldingen, en op een wijze die in ieder
    geval even duidelijk is als de naamsvermeldingen van de overige
    makers.\
    Volledigheidshalve dient te worden vermeld dat de Gebruiker
    uitsluitend gebruik mag maken van de naamsvermelding op de in dit
    artikel omschreven wijze teneinde te voldoen aan de
    naamsvermeldingsverplichting en, door gebruikmaking van zijn rechten
    krachtens deze Licentie, is het de Gebruiker niet toegestaan om op
    enigerlei wijze de indruk te wekken dat er sprake is van enig
    verband met, sponsorschap van of goedkeuring van de (toepasselijke)
    Maker, Licentiegever c.q. Naamsvermeldingsgerechtigden van de
    Gebruiker of diens gebruik van het Werk, zonder de afzonderlijke,
    uitdrukkelijke, voorafgaande, schriftelijke toestemming van de
    Maker, Licentiegever c.q. Naamsvermeldingsgerechtigden.

c.  Volledigheidshalve dient te worden vermeld, dat de hierboven
    vermelde beperkingen (lid 4(a) en lid 4(b)) niet van toepassing zijn
    op die onderdelen van het Werk die geacht worden te vallen onder de
    definitie van het 'Werk' zoals vermeld in deze Licentie uitsluitend
    omdat zij voldoen aan de criteria van het sui generis
    databankenrecht krachtens het nationale recht ter implementatie van
    de Europese Databankenrichtlijn.

d.  De in artikel 3 verleende rechten moeten worden uitgeoefend met
    inachtneming van het morele recht van de Maker (en/of de
    uitvoerende kunstenaar) om zich te verzetten tegen elke misvorming,
    verminking of andere aantasting van het werk, welke nadeel zou
    kunnen toebrengen aan de eer of de naam van de Maker (en/of de
    uitvoerende kunstenaar) of aan zijn waarde in deze hoedanigheid,
    indien en voor zover de Maker (en/of de uitvoerende kunstenaar) op
    grond van een op hem van toepassing zijnde wettelijke bepaling geen
    afstand kan doen van dat morele recht.

**5. Garantie en vrijwaring**

TENZIJ ANDERS SCHRIFTELIJK IS OVEREENGEKOMEN DOOR DE PARTIJEN, STELT DE
LICENTIEGEVER HET WERK BESCHIKBAAR OP 'AS-IS' BASIS, ZONDER ENIGE
GARANTIE, HETZIJ DIRECT, INDIRECT OF ANDERSZINS, MET BETREKKING TOT HET
WERK, MET INBEGRIP VAN, MAAR NIET BEPERKT TOT GARANTIES MET BETREKKING
TOT DE EIGENDOMSTITEL, DE VERKOOPBAARHEID, DE GESCHIKTHEID VOOR BEPAALDE
DOELEINDEN, MOGELIJKE INBREUK, DE AFWEZIGHEID VAN LATENTE OF ANDERE
TEKORTKOMINGEN, DE JUISTHEID OF DE AAN- OF AFWEZIGHEID VAN FOUTEN,
ONGEACHT DE OPSPOORBAARHEID DAARVAN, INDIEN EN VOORZOVER DE WET NIET
ANDERS BEPAALT.

**6. Beperking van de aansprakelijkheid**

DE LICENTIEGEVER AANVAARDT GEEN ENKELE AANSPRAKELIJKHEID JEGENS DE
GEBRUIKER VOOR ENIGE BIJZONDERE OF INCIDENTELE SCHADE OF GEVOLGSCHADE
VOORTVLOEIEND UIT DEZE LICENTIE OF HET GEBRUIK VAN HET WERK, ZELFS NIET
INDIEN DE LICENTIEGEVER OP DE HOOGTE IS GESTELD VAN HET RISICO VAN
DERGELIJKE SCHADE, INDIEN EN VOORZOVER DE WET NIET ANDERS BEPAALT.

**7. Beëindiging**

a.  Deze Licentie en de daarin verleende rechten vervallen automatisch
    op het moment dat de Gebruiker in strijd handelt met de voorwaarden
    van deze Licentie. De licenties van natuurlijke personen of
    rechtspersonen die Verzamelwerken hebben ontvangen van de Gebruiker
    krachtens deze Licentie blijven echter in stand zolang dergelijke
    natuurlijke personen of rechtspersonen zich houden aan de
    voorwaarden van die licenties. Na de beëindiging van deze Licentie
    blijven artikelen 1, 2, 5, 6, 7 en 8 onverminderd van kracht.

b.  Met inachtneming van de hierboven vermelde voorwaarden wordt de
    Licentie verleend voor de duur van de toepasselijke intellectuele
    eigendomsrechten op het Werk. De Licentiegever behoudt zich
    desalniettemin te allen tijde het recht voor om het Werk volgens
    gewijzigde licentievoorwaarden te verspreiden of om het Werk niet
    langer te verspreiden; met dien verstande dat een dergelijk besluit
    niet de intrekking van deze Licentie (of enig andere licentie die
    volgens de voorwaarden van deze Licentie (verplicht) is verleend)
    tot gevolg heeft, en deze Licentie onverminderd van kracht blijft
    tenzij zij op de in lid a omschreven wijze wordt beëindigd.

**8. Diversen**

a.  Elke keer dat de Gebruiker het Werk of een Verzamelwerk verspreidt
    of on-line beschikbaar stelt, biedt de Licentiegever de ontvanger
    een licentie op het Werk aan volgens de algemene voorwaarden van
    deze Licentie.

b.  Indien enige bepaling van deze Licentie nietig of niet rechtens
    afdwingbaar is, zullen de overige voorwaarden van deze Licentie
    volledig van kracht blijven. De nietige of niet-afdwingbare bepaling
    zal, zonder tussenkomst van de partijen, worden vervangen door een
    geldige en afdwingbare bepaling waarbij het doel en de strekking van
    de oorspronkelijke bepaling zoveel mogelijk in acht worden genomen.

c.  Een verklaring van afstand van in deze Licentie verleende rechten of
    een wijziging van de voorwaarden van deze Licentie dient
    schriftelijk te geschieden en getekend te zijn door de partij die
    verantwoordelijk is voor de verklaring van afstand respectievelijk
    de partij wiens toestemming voor de wijziging is vereist.

d.  Deze Licentie bevat de volledige overeenkomst tussen de partijen met
    betrekking tot het in licentie gegeven Werk. Er zijn geen andere
    afspraken gemaakt met betrekking tot het Werk. De Licentiegever is
    niet gebonden aan enige aanvullende bepalingen die worden vermeld in
    mededelingen van de Gebruiker. Deze licentie kan uitsluitend worden
    gewijzigd met de wederzijdse, schriftelijke instemming van de
    Licentiegever en de Gebruiker.

[^1]: Op dit moment zijn er nog geen BISON koppelvlakken vastgesteld
    voor dagplan of omleidingen.

[^2]: Niet van toepassing voor volatiele koppelvlaken zoals 6, 8, 19.
